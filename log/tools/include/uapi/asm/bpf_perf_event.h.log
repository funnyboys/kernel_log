commit eb9928bed003dd61a443d0ba51ae066429fbe735
Author: Björn Töpel <bjorn.topel@gmail.com>
Date:   Mon Dec 16 10:13:42 2019 +0100

    riscv, bpf: Add missing uapi header for BPF_PROG_TYPE_PERF_EVENT programs
    
    Add missing uapi header the BPF_PROG_TYPE_PERF_EVENT programs by
    exporting struct user_regs_struct instead of struct pt_regs which is
    in-kernel only.
    
    Signed-off-by: Björn Töpel <bjorn.topel@gmail.com>
    Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
    Link: https://lore.kernel.org/bpf/20191216091343.23260-9-bjorn.topel@gmail.com

diff --git a/tools/include/uapi/asm/bpf_perf_event.h b/tools/include/uapi/asm/bpf_perf_event.h
index 13a58531e6fa..39acc149d843 100644
--- a/tools/include/uapi/asm/bpf_perf_event.h
+++ b/tools/include/uapi/asm/bpf_perf_event.h
@@ -2,6 +2,8 @@
 #include "../../arch/arm64/include/uapi/asm/bpf_perf_event.h"
 #elif defined(__s390__)
 #include "../../arch/s390/include/uapi/asm/bpf_perf_event.h"
+#elif defined(__riscv)
+#include "../../arch/riscv/include/uapi/asm/bpf_perf_event.h"
 #else
 #include <uapi/asm-generic/bpf_perf_event.h>
 #endif

commit 720f228e8d3128b7ab1d39f51fdd8da07a7640c9
Author: Daniel Borkmann <daniel@iogearbox.net>
Date:   Tue Dec 12 02:25:32 2017 +0100

    bpf: fix broken BPF selftest build
    
    At least on x86_64, the kernel's BPF selftests seemed to have stopped
    to build due to 618e165b2a8e ("selftests/bpf: sync kernel headers and
    introduce arch support in Makefile"):
    
      [...]
      In file included from test_verifier.c:29:0:
      ../../../include/uapi/linux/bpf_perf_event.h:11:32:
         fatal error: asm/bpf_perf_event.h: No such file or directory
       #include <asm/bpf_perf_event.h>
                                    ^
      compilation terminated.
      [...]
    
    While pulling in tools/arch/*/include/uapi/asm/bpf_perf_event.h seems
    to work fine, there's no automated fall-back logic right now that would
    do the same out of tools/include/uapi/asm-generic/bpf_perf_event.h. The
    usual convention today is to add a include/[uapi/]asm/ equivalent that
    would pull in the correct arch header or generic one as fall-back, all
    ifdef'ed based on compiler target definition. It's similarly done also
    in other cases such as tools/include/asm/barrier.h, thus adapt the same
    here.
    
    Fixes: 618e165b2a8e ("selftests/bpf: sync kernel headers and introduce arch support in Makefile")
    Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
    Cc: Hendrik Brueckner <brueckner@linux.vnet.ibm.com>
    Cc: Arnaldo Carvalho de Melo <acme@kernel.org>
    Acked-by: Alexei Starovoitov <ast@kernel.org>
    Signed-off-by: Alexei Starovoitov <ast@kernel.org>

diff --git a/tools/include/uapi/asm/bpf_perf_event.h b/tools/include/uapi/asm/bpf_perf_event.h
new file mode 100644
index 000000000000..13a58531e6fa
--- /dev/null
+++ b/tools/include/uapi/asm/bpf_perf_event.h
@@ -0,0 +1,7 @@
+#if defined(__aarch64__)
+#include "../../arch/arm64/include/uapi/asm/bpf_perf_event.h"
+#elif defined(__s390__)
+#include "../../arch/s390/include/uapi/asm/bpf_perf_event.h"
+#else
+#include <uapi/asm-generic/bpf_perf_event.h>
+#endif
