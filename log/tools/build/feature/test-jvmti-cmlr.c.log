commit dd1d0044dd1c1bf84a9b3e1f24e43347b26b96a0
Author: Jiri Olsa <jolsa@kernel.org>
Date:   Wed Nov 21 16:43:41 2018 +0100

    perf jvmti: Separate jvmti cmlr check
    
    The Compiled Method Load Record (cmlr) is JDK specific interface to
    access JVM stack info. This makes the jvmti agent code not compile under
    another jdk, which does not support that.
    
    Separating jvmti cmlr check into special feature check, and adding
    HAVE_JVMTI_CMLR macro to indicate that.
    
    Mark cmlr code in jvmti/libjvmti.c with HAVE_JVMTI_CMLR, so we can
    compile it on system without cmlr support.
    
    This change makes the jvmti compile with java-1.8.0-ibm package. It's
    without the line numbers support, but the rest works.
    
    Adding NO_JVMTI_CMLR compile variable for testing.
    
    Signed-off-by: Jiri Olsa <jolsa@kernel.org>
    Cc: Alexander Shishkin <alexander.shishkin@linux.intel.com>
    Cc: Ben Gainey <ben.gainey@arm.com>
    Cc: Gustavo Luiz Duarte <gduarte@redhat.com>
    Cc: Namhyung Kim <namhyung@kernel.org>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: Stephane Eranian <eranian@google.com>
    Link: http://lkml.kernel.org/r/20181121154341.21521-1-jolsa@kernel.org
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

diff --git a/tools/build/feature/test-jvmti-cmlr.c b/tools/build/feature/test-jvmti-cmlr.c
new file mode 100644
index 000000000000..c27b5b71a0f6
--- /dev/null
+++ b/tools/build/feature/test-jvmti-cmlr.c
@@ -0,0 +1,11 @@
+// SPDX-License-Identifier: GPL-2.0
+#include <jvmti.h>
+#include <jvmticmlr.h>
+
+int main(void)
+{
+	jvmtiCompiledMethodLoadInlineRecord	rec __attribute__((unused));
+	jvmtiCompiledMethodLoadRecordHeader	hdr __attribute__((unused));
+	PCStackInfo				p   __attribute__((unused));
+	return 0;
+}
