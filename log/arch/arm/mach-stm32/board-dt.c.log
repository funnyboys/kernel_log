commit 2092e3adc323695255bd06d65f14c89afb5727ae
Author: Benjamin Gaignard <benjamin.gaignard@linaro.org>
Date:   Tue Feb 27 15:36:00 2018 +0100

    ARM: stm32: restore reboot capabilities
    
    To be able to reboot the platform we need to use armv7m_restart for STM32
    SoCs using ARMv7 cores.
    
    Fixes: e0644101bd2f ("ARM: mach-stm32: prepare stm32 family to welcome armv7 architecture)
    
    Signed-off-by: Benjamin Gaignard <benjamin.gaignard@st.com>
    Signed-off-by: Alexandre Torgue <alexandre.torgue@st.com>

diff --git a/arch/arm/mach-stm32/board-dt.c b/arch/arm/mach-stm32/board-dt.c
index 06911ad60cea..011d57b488c2 100644
--- a/arch/arm/mach-stm32/board-dt.c
+++ b/arch/arm/mach-stm32/board-dt.c
@@ -7,6 +7,9 @@
 
 #include <linux/kernel.h>
 #include <asm/mach/arch.h>
+#ifdef CONFIG_ARM_SINGLE_ARMV7M
+#include <asm/v7m.h>
+#endif
 
 static const char *const stm32_compat[] __initconst = {
 	"st,stm32f429",
@@ -20,4 +23,7 @@ static const char *const stm32_compat[] __initconst = {
 
 DT_MACHINE_START(STM32DT, "STM32 (Device Tree Support)")
 	.dt_compat = stm32_compat,
+#ifdef CONFIG_ARM_SINGLE_ARMV7M
+	.restart = armv7m_restart,
+#endif
 MACHINE_END

commit f7dcb04475b24e8c655aa8f285450ada17c16ebf
Author: Ludovic Barre <ludovic.barre@st.com>
Date:   Tue Jan 16 15:56:00 2018 +0100

    ARM: stm32: add initial support for STM32MP157
    
    This patch adds initial support of STM32MP157 microprocessor (MPU)
    based on Arm Cortex-A7. New Cortex-A infrastructure (gic, timer,...)
    are selected if ARCH_MULTI_V7 is defined.
    
    Signed-off-by: Ludovic Barre <ludovic.barre@st.com>
    Signed-off-by: Alexandre Torgue <alexandre.torgue@st.com>

diff --git a/arch/arm/mach-stm32/board-dt.c b/arch/arm/mach-stm32/board-dt.c
index 6786f357851f..06911ad60cea 100644
--- a/arch/arm/mach-stm32/board-dt.c
+++ b/arch/arm/mach-stm32/board-dt.c
@@ -14,6 +14,7 @@ static const char *const stm32_compat[] __initconst = {
 	"st,stm32f746",
 	"st,stm32f769",
 	"st,stm32h743",
+	"st,stm32mp157",
 	NULL
 };
 

commit 3ed71f8ad98a07803299693481b03fa6391e094f
Author: Ludovic Barre <ludovic.barre@st.com>
Date:   Tue Feb 27 09:05:18 2018 +0100

    ARM: stm32: prepare stm32 family to welcome armv7 architecture
    
    This patch prepares the STM32 machine for the integration of Cortex-A
    based microprocessor (MPU), on top of the existing Cortex-M
    microcontroller family (MCU). Since both MCUs and MPUs are sharing
    common hardware blocks we can keep using ARCH_STM32 flag for most of
    them. If a hardware block is specific to one family we can use either
    ARM_SINGLE_ARMV7M or ARCH_MULTI_V7 flag.
    
    Signed-off-by: Ludovic Barre <ludovic.barre@st.com>
    Signed-off-by: Alexandre Torgue <alexandre.torgue@st.com>

diff --git a/arch/arm/mach-stm32/board-dt.c b/arch/arm/mach-stm32/board-dt.c
index 8c682f4a8ffc..6786f357851f 100644
--- a/arch/arm/mach-stm32/board-dt.c
+++ b/arch/arm/mach-stm32/board-dt.c
@@ -6,7 +6,6 @@
  */
 
 #include <linux/kernel.h>
-#include <asm/v7m.h>
 #include <asm/mach/arch.h>
 
 static const char *const stm32_compat[] __initconst = {
@@ -20,5 +19,4 @@ static const char *const stm32_compat[] __initconst = {
 
 DT_MACHINE_START(STM32DT, "STM32 (Device Tree Support)")
 	.dt_compat = stm32_compat,
-	.restart = armv7m_restart,
 MACHINE_END

commit 61ea291cff9e8cc4b35d84c73b2659b628d4ff9b
Author: Benjamin Gaignard <benjamin.gaignard@linaro.org>
Date:   Thu Nov 30 09:49:00 2017 +0100

    ARM: stm32: Fix copyright
    
    Uniformize STMicroelectronics copyrights header
    Add SPDX identifier
    
    Signed-off-by: Benjamin Gaignard <benjamin.gaignard@st.com>
    CC: Maxime Coquelin <mcoquelin.stm32@gmail.com>
    Acked-by: Maxime Coquelin <mcoquelin.stm32@gmail.com>
    Signed-off-by: Alexandre Torgue <alexandre.torgue@st.com>

diff --git a/arch/arm/mach-stm32/board-dt.c b/arch/arm/mach-stm32/board-dt.c
index 48246325c6cc..8c682f4a8ffc 100644
--- a/arch/arm/mach-stm32/board-dt.c
+++ b/arch/arm/mach-stm32/board-dt.c
@@ -1,7 +1,8 @@
+// SPDX-License-Identifier: GPL-2.0
 /*
  * Copyright (C) Maxime Coquelin 2015
+ * Copyright (C) STMicroelectronics 2017
  * Author:  Maxime Coquelin <mcoquelin.stm32@gmail.com>
- * License terms:  GNU General Public License (GPL), version 2
  */
 
 #include <linux/kernel.h>

commit 85beb77f87f750b3b363ddc427708338522f3909
Author: Alexandre Torgue <alexandre.torgue@st.com>
Date:   Mon Dec 11 09:54:00 2017 +0100

    ARM: stm32: add new STM32F769 MCU
    
    Add new st,stm32f769 compatible machine name for STM32F769 MCU and update
    documentation.
    
    Signed-off-by: Alexandre Torgue <alexandre.torgue@st.com>

diff --git a/arch/arm/mach-stm32/board-dt.c b/arch/arm/mach-stm32/board-dt.c
index e918686e4191..48246325c6cc 100644
--- a/arch/arm/mach-stm32/board-dt.c
+++ b/arch/arm/mach-stm32/board-dt.c
@@ -12,6 +12,7 @@ static const char *const stm32_compat[] __initconst = {
 	"st,stm32f429",
 	"st,stm32f469",
 	"st,stm32f746",
+	"st,stm32f769",
 	"st,stm32h743",
 	NULL
 };

commit c6ed0f31ce3e1c5729d1c8f81a2a94ab881506a6
Author: Alexandre TORGUE <alexandre.torgue@st.com>
Date:   Mon Jan 30 17:46:23 2017 +0100

    ARM: stm32: Add a new SOC - STM32H743
    
    The STM32H743 is a Cortex-M7 MCU running at 400MHz and containing 1MBytes
    internal RAM.
    
    Signed-off-by: Alexandre TORGUE <alexandre.torgue@st.com>

diff --git a/arch/arm/mach-stm32/board-dt.c b/arch/arm/mach-stm32/board-dt.c
index c354222a4158..e918686e4191 100644
--- a/arch/arm/mach-stm32/board-dt.c
+++ b/arch/arm/mach-stm32/board-dt.c
@@ -12,6 +12,7 @@ static const char *const stm32_compat[] __initconst = {
 	"st,stm32f429",
 	"st,stm32f469",
 	"st,stm32f746",
+	"st,stm32h743",
 	NULL
 };
 

commit a77e393c321fb728acbf72533f8f573aa9a7cb63
Author: Alexandre TORGUE <alexandre.torgue@st.com>
Date:   Tue Nov 15 12:02:33 2016 +0100

    ARM: mach-stm32: Add a new SOC - STM32F746
    
    Signed-off-by: Alexandre TORGUE <alexandre.torgue@st.com>

diff --git a/arch/arm/mach-stm32/board-dt.c b/arch/arm/mach-stm32/board-dt.c
index ceee47735eec..c354222a4158 100644
--- a/arch/arm/mach-stm32/board-dt.c
+++ b/arch/arm/mach-stm32/board-dt.c
@@ -11,6 +11,7 @@
 static const char *const stm32_compat[] __initconst = {
 	"st,stm32f429",
 	"st,stm32f469",
+	"st,stm32f746",
 	NULL
 };
 

commit 6391503bbf4508ca97e9806b5347d3fd5d3c8c3c
Author: Lee Jones <lee.jones@linaro.org>
Date:   Tue Feb 16 15:17:00 2016 +0100

    ARM: stm32: Identify a new SoC - STM32F469
    
    Signed-off-by: Lee Jones <lee.jones@linaro.org>
    Acked-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Maxime Coquelin <mcoquelin.stm32@gmail.com>

diff --git a/arch/arm/mach-stm32/board-dt.c b/arch/arm/mach-stm32/board-dt.c
index f2ad7723d034..ceee47735eec 100644
--- a/arch/arm/mach-stm32/board-dt.c
+++ b/arch/arm/mach-stm32/board-dt.c
@@ -10,6 +10,7 @@
 
 static const char *const stm32_compat[] __initconst = {
 	"st,stm32f429",
+	"st,stm32f469",
 	NULL
 };
 

commit 9b799b78372c925d3204567741e3ff8fe0cc1c7d
Author: Maxime Coquelin <mcoquelin.stm32@gmail.com>
Date:   Sat May 9 09:53:54 2015 +0200

    ARM: Add STM32 family machine
    
    STMicrolectronics's STM32 series is a family of Cortex-M
    microcontrollers. It is used in various applications, and
    proposes a wide range of peripherals.
    
    Tested-by: Chanwoo Choi <cw00.choi@samsung.com>
    Signed-off-by: Maxime Coquelin <mcoquelin.stm32@gmail.com>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

diff --git a/arch/arm/mach-stm32/board-dt.c b/arch/arm/mach-stm32/board-dt.c
new file mode 100644
index 000000000000..f2ad7723d034
--- /dev/null
+++ b/arch/arm/mach-stm32/board-dt.c
@@ -0,0 +1,19 @@
+/*
+ * Copyright (C) Maxime Coquelin 2015
+ * Author:  Maxime Coquelin <mcoquelin.stm32@gmail.com>
+ * License terms:  GNU General Public License (GPL), version 2
+ */
+
+#include <linux/kernel.h>
+#include <asm/v7m.h>
+#include <asm/mach/arch.h>
+
+static const char *const stm32_compat[] __initconst = {
+	"st,stm32f429",
+	NULL
+};
+
+DT_MACHINE_START(STM32DT, "STM32 (Device Tree Support)")
+	.dt_compat = stm32_compat,
+	.restart = armv7m_restart,
+MACHINE_END
