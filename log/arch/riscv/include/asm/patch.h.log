commit b80b3d582ebd8c7c49687319b3c624e03c4b2b93
Author: Zong Li <zong.li@sifive.com>
Date:   Tue Apr 21 15:29:59 2020 +0800

    riscv: Remove the 'riscv_' prefix of function name
    
    Refactor the function name by removing the 'riscv_' prefix, it would be
    better unless it could mix up with arch-independent functions.
    
    Signed-off-by: Zong Li <zong.li@sifive.com>
    Reviewed-by: Masami Hiramatsu <mhiramat@kernel.org>
    Reviewed-by: Palmer Dabbelt <palmerdabbelt@google.com>
    Signed-off-by: Palmer Dabbelt <palmerdabbelt@google.com>

diff --git a/arch/riscv/include/asm/patch.h b/arch/riscv/include/asm/patch.h
index b5918a6e0615..9a7d7346001e 100644
--- a/arch/riscv/include/asm/patch.h
+++ b/arch/riscv/include/asm/patch.h
@@ -6,7 +6,7 @@
 #ifndef _ASM_RISCV_PATCH_H
 #define _ASM_RISCV_PATCH_H
 
-int riscv_patch_text_nosync(void *addr, const void *insns, size_t len);
-int riscv_patch_text(void *addr, u32 insn);
+int patch_text_nosync(void *addr, const void *insns, size_t len);
+int patch_text(void *addr, u32 insn);
 
 #endif /* _ASM_RISCV_PATCH_H */

commit 043cb41a85de1c0e944da61ad7a264960e22c865
Author: Zong Li <zong.li@sifive.com>
Date:   Tue Mar 10 00:55:43 2020 +0800

    riscv: introduce interfaces to patch kernel code
    
    On strict kernel memory permission, we couldn't patch code without
    writable permission. Preserve two holes in fixmap area, so we can map
    the kernel code temporarily to fixmap area, then patch the instructions.
    
    We need two pages here because we support the compressed instruction, so
    the instruction might be align to 2 bytes. When patching the 32-bit
    length instruction which is 2 bytes alignment, it will across two pages.
    
    Introduce two interfaces to patch kernel code:
    riscv_patch_text_nosync:
     - patch code without synchronization, it's caller's responsibility to
       synchronize all CPUs if needed.
    riscv_patch_text:
     - patch code and always synchronize with stop_machine()
    
    Signed-off-by: Zong Li <zong.li@sifive.com>
    Signed-off-by: Palmer Dabbelt <palmerdabbelt@google.com>

diff --git a/arch/riscv/include/asm/patch.h b/arch/riscv/include/asm/patch.h
new file mode 100644
index 000000000000..b5918a6e0615
--- /dev/null
+++ b/arch/riscv/include/asm/patch.h
@@ -0,0 +1,12 @@
+/* SPDX-License-Identifier: GPL-2.0-only */
+/*
+ * Copyright (C) 2020 SiFive
+ */
+
+#ifndef _ASM_RISCV_PATCH_H
+#define _ASM_RISCV_PATCH_H
+
+int riscv_patch_text_nosync(void *addr, const void *insns, size_t len);
+int riscv_patch_text(void *addr, u32 insn);
+
+#endif /* _ASM_RISCV_PATCH_H */
