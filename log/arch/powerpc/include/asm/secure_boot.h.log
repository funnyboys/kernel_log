commit 2702809a4a1ab414d75c00936cda70ea77c8234e
Author: Nayna Jain <nayna@linux.ibm.com>
Date:   Tue Nov 5 17:02:07 2019 -0600

    powerpc: Detect the trusted boot state of the system
    
    While secure boot permits only properly verified signed kernels to be
    booted, trusted boot calculates the file hash of the kernel image and
    stores the measurement prior to boot, that can be subsequently
    compared against good known values via attestation services.
    
    This patch reads the trusted boot state of a PowerNV system. The state
    is used to conditionally enable additional measurement rules in the
    IMA arch-specific policies.
    
    Signed-off-by: Nayna Jain <nayna@linux.ibm.com>
    Signed-off-by: Eric Richter <erichte@linux.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/e9eeee6b-b9bf-1e41-2954-61dbd6fbfbcf@linux.ibm.com

diff --git a/arch/powerpc/include/asm/secure_boot.h b/arch/powerpc/include/asm/secure_boot.h
index 07d0fe0ca81f..a2ff556916c6 100644
--- a/arch/powerpc/include/asm/secure_boot.h
+++ b/arch/powerpc/include/asm/secure_boot.h
@@ -11,6 +11,7 @@
 #ifdef CONFIG_PPC_SECURE_BOOT
 
 bool is_ppc_secureboot_enabled(void);
+bool is_ppc_trustedboot_enabled(void);
 
 #else
 
@@ -19,5 +20,10 @@ static inline bool is_ppc_secureboot_enabled(void)
 	return false;
 }
 
+static inline bool is_ppc_trustedboot_enabled(void)
+{
+	return false;
+}
+
 #endif
 #endif

commit 1a8916ee3ac29054322cdac687d36e1b5894d272
Author: Nayna Jain <nayna@linux.ibm.com>
Date:   Tue Nov 5 17:00:22 2019 -0600

    powerpc: Detect the secure boot mode of the system
    
    This patch defines a function to detect the secure boot state of a
    PowerNV system.
    
    The PPC_SECURE_BOOT config represents the base enablement of secure
    boot for powerpc.
    
    Signed-off-by: Nayna Jain <nayna@linux.ibm.com>
    Signed-off-by: Eric Richter <erichte@linux.ibm.com>
    [mpe: Fold in change from Nayna to add "ibm,secureboot" to ids]
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/46b003b9-3225-6bf7-9101-ed6580bb748c@linux.ibm.com

diff --git a/arch/powerpc/include/asm/secure_boot.h b/arch/powerpc/include/asm/secure_boot.h
new file mode 100644
index 000000000000..07d0fe0ca81f
--- /dev/null
+++ b/arch/powerpc/include/asm/secure_boot.h
@@ -0,0 +1,23 @@
+/* SPDX-License-Identifier: GPL-2.0 */
+/*
+ * Secure boot definitions
+ *
+ * Copyright (C) 2019 IBM Corporation
+ * Author: Nayna Jain
+ */
+#ifndef _ASM_POWER_SECURE_BOOT_H
+#define _ASM_POWER_SECURE_BOOT_H
+
+#ifdef CONFIG_PPC_SECURE_BOOT
+
+bool is_ppc_secureboot_enabled(void);
+
+#else
+
+static inline bool is_ppc_secureboot_enabled(void)
+{
+	return false;
+}
+
+#endif
+#endif
