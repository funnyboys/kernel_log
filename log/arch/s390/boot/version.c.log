commit 6abe28197024f732f1e298b1a593505282505857
Author: Vasily Gorbik <gor@linux.ibm.com>
Date:   Mon Jul 15 15:30:33 2019 +0200

    s390: enable detection of kernel version from bzImage
    
    Extend "parmarea" to include an offset of the version string, which is
    stored as 8-byte big endian value.
    
    To retrieve version string from bzImage reliably, one should check the
    presence of "S390EP" ascii string at 0x10008 (available since v3.2),
    then read the version string offset from 0x10428 (which has been 0
    since v3.2 up to now). The string is null terminated.
    
    Could be retrieved with the following "file" command magic (requires
    file v5.34):
    8 string \x02\x00\x00\x18\x60\x00\x00\x50\x02\x00\x00\x68\x60\x00\x00\x50\x40\x40\x40\x40\x40\x40\x40\x40 Linux S390
    >0x10008       string          S390EP
    >>0x10428      bequad          >0
    >>>(0x10428.Q) string          >\0             \b, version %s
    
    Reported-by: Petr Tesarik <ptesarik@suse.com>
    Suggested-by: Petr Tesarik <ptesarik@suse.com>
    Reviewed-by: Heiko Carstens <heiko.carstens@de.ibm.com>
    Signed-off-by: Vasily Gorbik <gor@linux.ibm.com>
    Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com>

diff --git a/arch/s390/boot/version.c b/arch/s390/boot/version.c
new file mode 100644
index 000000000000..d32e58bdda6a
--- /dev/null
+++ b/arch/s390/boot/version.c
@@ -0,0 +1,7 @@
+// SPDX-License-Identifier: GPL-2.0
+#include <generated/utsrelease.h>
+#include <generated/compile.h>
+#include "boot.h"
+
+const char kernel_version[] = UTS_RELEASE
+	" (" LINUX_COMPILE_BY "@" LINUX_COMPILE_HOST ") " UTS_VERSION;
