commit 268a78404973594d1a7ec3a2b6a2474e0543a435
Author: Philipp Rudo <prudo@linux.ibm.com>
Date:   Tue Mar 26 15:45:53 2019 +0100

    s390/kexec_file: Disable kexec_load when IPLed secure
    
    A kernel loaded via kexec_load cannot be verified. Thus disable kexec_load
    systemcall in kernels which where IPLed securely. Use the IMA mechanism to
    do so.
    
    Signed-off-by: Philipp Rudo <prudo@linux.ibm.com>
    Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>

diff --git a/arch/s390/kernel/ima_arch.c b/arch/s390/kernel/ima_arch.c
new file mode 100644
index 000000000000..f3c3e6e1c5d3
--- /dev/null
+++ b/arch/s390/kernel/ima_arch.c
@@ -0,0 +1,14 @@
+// SPDX-License-Identifier: GPL-2.0
+
+#include <linux/ima.h>
+#include <asm/boot_data.h>
+
+bool arch_ima_get_secureboot(void)
+{
+	return ipl_secure_flag;
+}
+
+const char * const *arch_get_ima_policy(void)
+{
+	return NULL;
+}
