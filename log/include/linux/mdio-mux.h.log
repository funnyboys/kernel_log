commit 5482a978b962abd23f17a004e46d255d11646c20
Author: Corentin Labbe <clabbe.montjoie@gmail.com>
Date:   Mon Sep 4 18:30:14 2017 +0200

    net: mdio-mux: add mdio_mux parameter to mdio_mux_init()
    
    mdio_mux_init() use the parameter dev for two distinct thing:
    1) Have a device for all devm_ functions
    2) Get device_node from it
    
    Since it is two distinct purpose, this patch add a parameter mdio_mux
    that is linked to task 2.
    
    This will also permit to register an of_node mdio-mux that lacks a direct
    owning device.
    For example a mdio-mux which is a subnode of a real device.
    
    Signed-off-by: Corentin Labbe <clabbe.montjoie@gmail.com>
    Reviewed-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/include/linux/mdio-mux.h b/include/linux/mdio-mux.h
index 61f5b21b31c7..a5d58f221939 100644
--- a/include/linux/mdio-mux.h
+++ b/include/linux/mdio-mux.h
@@ -12,7 +12,16 @@
 #include <linux/device.h>
 #include <linux/phy.h>
 
+/* mdio_mux_init() - Initialize a MDIO mux
+ * @dev		The device owning the MDIO mux
+ * @mux_node	The device node of the MDIO mux
+ * @switch_fn	The function called for switching target MDIO child
+ * mux_handle	A pointer to a (void *) used internaly by mdio-mux
+ * @data	Private data used by switch_fn()
+ * @mux_bus	An optional parent bus (Other case are to use parent_bus property)
+ */
 int mdio_mux_init(struct device *dev,
+		  struct device_node *mux_node,
 		  int (*switch_fn) (int cur, int desired, void *data),
 		  void **mux_handle,
 		  void *data,

commit f20e6657a8758fe8d074889a6f1883674f01c7f2
Author: Pramod Kumar <pramod.kumar@broadcom.com>
Date:   Fri Jun 10 11:03:45 2016 +0530

    mdio: mux: Enhanced MDIO mux framework for integrated multiplexers
    
    An integrated multiplexer uses same address space for
    "muxed bus selection" and "generation of mdio transaction"
    hence its good to register parent bus from mux driver.
    
    Hence added a mechanism where mux driver could register a
    parent bus and pass it down to framework via mdio_mux_init api.
    
    Signed-off-by: Pramod Kumar <pramod.kumar@broadcom.com>
    Reviewed-by: Andrew Lunn <andrew@lunn.ch>
    Reviewed-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/include/linux/mdio-mux.h b/include/linux/mdio-mux.h
index a243dbba8659..61f5b21b31c7 100644
--- a/include/linux/mdio-mux.h
+++ b/include/linux/mdio-mux.h
@@ -10,11 +10,13 @@
 #ifndef __LINUX_MDIO_MUX_H
 #define __LINUX_MDIO_MUX_H
 #include <linux/device.h>
+#include <linux/phy.h>
 
 int mdio_mux_init(struct device *dev,
 		  int (*switch_fn) (int cur, int desired, void *data),
 		  void **mux_handle,
-		  void *data);
+		  void *data,
+		  struct mii_bus *mux_bus);
 
 void mdio_mux_uninit(void *mux_handle);
 

commit 0ca2997d145268e6b4ef000692061849cdab8348
Author: David Daney <david.daney@cavium.com>
Date:   Wed May 2 15:16:38 2012 +0000

    netdev/of/phy: Add MDIO bus multiplexer support.
    
    This patch adds a somewhat generic framework for MDIO bus
    multiplexers.  It is modeled on the I2C multiplexer.
    
    The multiplexer is needed if there are multiple PHYs with the same
    address connected to the same MDIO bus adepter, or if there is
    insufficient electrical drive capability for all the connected PHY
    devices.
    
    Conceptually it could look something like this:
    
                       ------------------
                       | Control Signal |
                       --------+---------
                               |
     ---------------   --------+------
     | MDIO MASTER |---| Multiplexer |
     ---------------   --+-------+----
                         |       |
                         C       C
                         h       h
                         i       i
                         l       l
                         d       d
                         |       |
         ---------       A       B   ---------
         |       |       |       |   |       |
         | PHY@1 +-------+       +---+ PHY@1 |
         |       |       |       |   |       |
         ---------       |       |   ---------
         ---------       |       |   ---------
         |       |       |       |   |       |
         | PHY@2 +-------+       +---+ PHY@2 |
         |       |                   |       |
         ---------                   ---------
    
    This framework configures the bus topology from device tree data.  The
    mechanics of switching the multiplexer is left to device specific
    drivers.
    
    The follow-on patch contains a multiplexer driven by GPIO lines.
    
    Signed-off-by: David Daney <david.daney@cavium.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/include/linux/mdio-mux.h b/include/linux/mdio-mux.h
new file mode 100644
index 000000000000..a243dbba8659
--- /dev/null
+++ b/include/linux/mdio-mux.h
@@ -0,0 +1,21 @@
+/*
+ * MDIO bus multiplexer framwork.
+ *
+ * This file is subject to the terms and conditions of the GNU General Public
+ * License.  See the file "COPYING" in the main directory of this archive
+ * for more details.
+ *
+ * Copyright (C) 2011, 2012 Cavium, Inc.
+ */
+#ifndef __LINUX_MDIO_MUX_H
+#define __LINUX_MDIO_MUX_H
+#include <linux/device.h>
+
+int mdio_mux_init(struct device *dev,
+		  int (*switch_fn) (int cur, int desired, void *data),
+		  void **mux_handle,
+		  void *data);
+
+void mdio_mux_uninit(void *mux_handle);
+
+#endif /* __LINUX_MDIO_MUX_H */
