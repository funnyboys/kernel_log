commit 19e99de9a53f9ece6baf8e9a15428aedd4b20c86
Author: Bartosz Golaszewski <bgolaszewski@baylibre.com>
Date:   Tue Jan 8 10:15:36 2019 +0100

    ARM: davinci: remove dead code related to MAC address reading
    
    There are no more users of davinci_get_mac_addr(). Remove it.
    
    Signed-off-by: Bartosz Golaszewski <bgolaszewski@baylibre.com>
    Signed-off-by: Sekhar Nori <nsekhar@ti.com>

diff --git a/include/linux/davinci_emac.h b/include/linux/davinci_emac.h
index 05b97144d342..28e6cf1356da 100644
--- a/include/linux/davinci_emac.h
+++ b/include/linux/davinci_emac.h
@@ -46,5 +46,4 @@ enum {
 	EMAC_VERSION_2,	/* DM646x */
 };
 
-void davinci_get_mac_addr(struct nvmem_device *nvmem, void *context);
 #endif

commit bec3c11bad0e7ac05fb90f204d0ab6f79945822b
Author: Andrew Lunn <andrew@lunn.ch>
Date:   Fri Feb 26 20:59:24 2016 +0100

    misc: at24: replace memory_accessor with nvmem_device_read
    
    Now that the AT24 uses the NVMEM framework, replace the
    memory_accessor in the setup() callback with nvmem API calls.
    
    Signed-off-by: Andrew Lunn <andrew@lunn.ch>
    Acked-by: Srinivas Kandagatla <srinivas.kandagatla@linaro.org>
    Tested-by: Sekhar Nori <nsekhar@ti.com>
    Acked-by: Wolfram Sang <wsa@the-dreams.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/include/linux/davinci_emac.h b/include/linux/davinci_emac.h
index 542888504994..05b97144d342 100644
--- a/include/linux/davinci_emac.h
+++ b/include/linux/davinci_emac.h
@@ -12,7 +12,7 @@
 #define _LINUX_DAVINCI_EMAC_H
 
 #include <linux/if_ether.h>
-#include <linux/memory.h>
+#include <linux/nvmem-consumer.h>
 
 struct mdio_platform_data {
 	unsigned long		bus_freq;
@@ -46,5 +46,5 @@ enum {
 	EMAC_VERSION_2,	/* DM646x */
 };
 
-void davinci_get_mac_addr(struct memory_accessor *mem_acc, void *context);
+void davinci_get_mac_addr(struct nvmem_device *nvmem, void *context);
 #endif

commit 6a1fef6d000944911df0f160f366111daa10740a
Author: Sriram <srk@ti.com>
Date:   Tue Mar 22 02:31:03 2011 +0000

    net: davinci_emac:Fix translation logic for buffer descriptor
    
    With recent changes to the driver(switch to new cpdma layer),
    the support for buffer descriptor address translation logic
    is broken. This affects platforms where the physical address of
    the descriptors as seen by the DMA engine is different from the
    physical address.
    
    Original Patch adding translation logic support:
    Commit: ad021ae8862209864dc8ebd3b7d3a55ce84b9ea2
    
    Signed-off-by: Sriramakrishnan A G <srk@ti.com>
    Tested-By: Sekhar Nori <nsekhar@ti.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/include/linux/davinci_emac.h b/include/linux/davinci_emac.h
index 5dd428532f79..542888504994 100644
--- a/include/linux/davinci_emac.h
+++ b/include/linux/davinci_emac.h
@@ -36,6 +36,7 @@ struct emac_platform_data {
 
 	u8 rmii_en;
 	u8 version;
+	bool no_bd_ram;
 	void (*interrupt_enable) (void);
 	void (*interrupt_disable) (void);
 };

commit 7b3742aff1a9946b9b25f16d6a7ca22c10926391
Author: Cyril Chemparathy <cyril@ti.com>
Date:   Wed Sep 15 10:11:27 2010 -0400

    net: davinci_emac: cleanup unused mdio emac code
    
    This patch removes code that has been rendered useless by the previous patches
    in this series.
    
    Signed-off-by: Cyril Chemparathy <cyril@ti.com>
    Acked-by: David S. Miller <davem@davemloft.net>
    Tested-by: Michael Williamson <michael.williamson@criticallink.com>
    Tested-by: Caglar Akyuz <caglarakyuz@gmail.com>
    Signed-off-by: Kevin Hilman <khilman@deeprootsystems.com>

diff --git a/include/linux/davinci_emac.h b/include/linux/davinci_emac.h
index 46a759f0c082..5dd428532f79 100644
--- a/include/linux/davinci_emac.h
+++ b/include/linux/davinci_emac.h
@@ -24,10 +24,7 @@ struct emac_platform_data {
 	u32 ctrl_mod_reg_offset;
 	u32 ctrl_ram_offset;
 	u32 hw_ram_addr;
-	u32 mdio_reg_offset;
 	u32 ctrl_ram_size;
-	u32 phy_mask;
-	u32 mdio_max_freq;
 
 	/*
 	 * phy_id can be one of the following:

commit 5d69e0076a726588265af040b21ac3f8266856d1
Author: Cyril Chemparathy <cyril@ti.com>
Date:   Wed Sep 15 10:11:24 2010 -0400

    net: davinci_emac: switch to new mdio
    
    This patch switches the emac implementation over to the newly separated
    MDIO driver.
    
    With this, the mdio bus frequency defaults to a safe 2.2MHz.  Boards may
    optionally specify a bus frequency via platform data.
    
    The phy identification scheme has been modified to use a phy bus id instead
    of a mask.  This largely serves to eliminate the "phy search" code in emac
    init.
    
    Signed-off-by: Cyril Chemparathy <cyril@ti.com>
    Acked-by: David S. Miller <davem@davemloft.net>
    Tested-by: Michael Williamson <michael.williamson@criticallink.com>
    Tested-by: Caglar Akyuz <caglarakyuz@gmail.com>
    Signed-off-by: Kevin Hilman <khilman@deeprootsystems.com>

diff --git a/include/linux/davinci_emac.h b/include/linux/davinci_emac.h
index a04fd8c9fbdf..46a759f0c082 100644
--- a/include/linux/davinci_emac.h
+++ b/include/linux/davinci_emac.h
@@ -28,6 +28,15 @@ struct emac_platform_data {
 	u32 ctrl_ram_size;
 	u32 phy_mask;
 	u32 mdio_max_freq;
+
+	/*
+	 * phy_id can be one of the following:
+	 *   - NULL		: use the first phy on the bus,
+	 *   - ""		: force to 100/full, no mdio control
+	 *   - "<bus>:<addr>"	: use the specified bus and phy
+	 */
+	const char *phy_id;
+
 	u8 rmii_en;
 	u8 version;
 	void (*interrupt_enable) (void);

commit f20136eb03a1dbdfb04f3c62fd11c0d02d02b726
Author: Cyril Chemparathy <cyril@ti.com>
Date:   Wed Sep 15 10:11:21 2010 -0400

    net: davinci_emac: separate out davinci mdio
    
    Davinci's MDIO controller is present on other TI devices, without an
    accompanying EMAC.  For example, on tnetv107x, the same MDIO module is used in
    conjunction with a 3-port switch hardware.
    
    By separating the MDIO controller code into its own platform driver, this
    patch allows common logic to be reused on such platforms.
    
    Signed-off-by: Cyril Chemparathy <cyril@ti.com>
    Tested-by: Michael Williamson <michael.williamson@criticallink.com>
    Tested-by: Caglar Akyuz <caglarakyuz@gmail.com>
    Signed-off-by: Kevin Hilman <khilman@deeprootsystems.com>

diff --git a/include/linux/davinci_emac.h b/include/linux/davinci_emac.h
index 7c930dba477c..a04fd8c9fbdf 100644
--- a/include/linux/davinci_emac.h
+++ b/include/linux/davinci_emac.h
@@ -14,6 +14,10 @@
 #include <linux/if_ether.h>
 #include <linux/memory.h>
 
+struct mdio_platform_data {
+	unsigned long		bus_freq;
+};
+
 struct emac_platform_data {
 	char mac_addr[ETH_ALEN];
 	u32 ctrl_reg_offset;

commit ad021ae8862209864dc8ebd3b7d3a55ce84b9ea2
Author: Sriramakrishnan <srk@ti.com>
Date:   Thu Nov 19 15:58:27 2009 +0530

    TI Davinci EMAC : Abstract Buffer address translation logic.
    
    When programming the DMA engine, the next pointers must be
    programmed with physical address as seen from the DMA master
    address space. This address may be different from physical
    address of the buffer RAM area. This patch abstracts the
    buffer address translation logic.
    
    Signed-off-by: Sriramakrishnan <srk@ti.com>
    Acked-by: Chaithrika U S <chaithrika@ti.com>
    Acked-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Kevin Hilman <khilman@deeprootsystems.com>

diff --git a/include/linux/davinci_emac.h b/include/linux/davinci_emac.h
index 6d894efd8a3f..7c930dba477c 100644
--- a/include/linux/davinci_emac.h
+++ b/include/linux/davinci_emac.h
@@ -19,6 +19,7 @@ struct emac_platform_data {
 	u32 ctrl_reg_offset;
 	u32 ctrl_mod_reg_offset;
 	u32 ctrl_ram_offset;
+	u32 hw_ram_addr;
 	u32 mdio_reg_offset;
 	u32 ctrl_ram_size;
 	u32 phy_mask;

commit 01a9af36cd9d25fc71e28192974732d8053bd1c0
Author: Sriramakrishnan <srk@ti.com>
Date:   Thu Nov 19 15:58:26 2009 +0530

    TI Davinci EMAC : add platform specific interrupt enable/disable logic.
    
    On certain SOCs, the EMAC controller is interfaced with a wrapper logic
    for handling interrupts. This  patch implements a platform
    specific hook to cater to platforms that require custom interrupt
    handling logic
    
    Signed-off-by: Sriramakrishnan <srk@ti.com>
    Acked-by: Chaithrika U S <chaithrika@ti.com>
    Acked-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Kevin Hilman <khilman@deeprootsystems.com>

diff --git a/include/linux/davinci_emac.h b/include/linux/davinci_emac.h
index ff5548747df4..6d894efd8a3f 100644
--- a/include/linux/davinci_emac.h
+++ b/include/linux/davinci_emac.h
@@ -25,6 +25,8 @@ struct emac_platform_data {
 	u32 mdio_max_freq;
 	u8 rmii_en;
 	u8 version;
+	void (*interrupt_enable) (void);
+	void (*interrupt_disable) (void);
 };
 
 enum {

commit 8ee2bf9ab792d0c02b13ca3acbd036debb7745d9
Author: Sriramakrishnan <srk@ti.com>
Date:   Thu Nov 19 15:58:25 2009 +0530

    TI Davinci EMAC : Re-use driver for other platforms.
    
    The davinci EMAC peripheral is also available on other TI
    platforms -notably TI AM3517 SoC. This patch modifies the
    config option and the platform structure header files so that
    the driver can be reused on non-davinci platforms as well.
    
    Signed-off-by: Sriramakrishnan <srk@ti.com>
    Acked-by: Chaithrika U S <chaithrika@ti.com>
    Acked-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Kevin Hilman <khilman@deeprootsystems.com>

diff --git a/include/linux/davinci_emac.h b/include/linux/davinci_emac.h
new file mode 100644
index 000000000000..ff5548747df4
--- /dev/null
+++ b/include/linux/davinci_emac.h
@@ -0,0 +1,36 @@
+/*
+ * TI DaVinci EMAC platform support
+ *
+ * Author: Kevin Hilman, Deep Root Systems, LLC
+ *
+ * 2007 (c) Deep Root Systems, LLC. This file is licensed under
+ * the terms of the GNU General Public License version 2. This program
+ * is licensed "as is" without any warranty of any kind, whether express
+ * or implied.
+ */
+#ifndef _LINUX_DAVINCI_EMAC_H
+#define _LINUX_DAVINCI_EMAC_H
+
+#include <linux/if_ether.h>
+#include <linux/memory.h>
+
+struct emac_platform_data {
+	char mac_addr[ETH_ALEN];
+	u32 ctrl_reg_offset;
+	u32 ctrl_mod_reg_offset;
+	u32 ctrl_ram_offset;
+	u32 mdio_reg_offset;
+	u32 ctrl_ram_size;
+	u32 phy_mask;
+	u32 mdio_max_freq;
+	u8 rmii_en;
+	u8 version;
+};
+
+enum {
+	EMAC_VERSION_1,	/* DM644x */
+	EMAC_VERSION_2,	/* DM646x */
+};
+
+void davinci_get_mac_addr(struct memory_accessor *mem_acc, void *context);
+#endif
