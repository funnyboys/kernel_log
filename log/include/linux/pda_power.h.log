commit d2912cb15bdda8ba4a5dd73396ad62641af2f520
Author: Thomas Gleixner <tglx@linutronix.de>
Date:   Tue Jun 4 10:11:33 2019 +0200

    treewide: Replace GPLv2 boilerplate/reference with SPDX - rule 500
    
    Based on 2 normalized pattern(s):
    
      this program is free software you can redistribute it and or modify
      it under the terms of the gnu general public license version 2 as
      published by the free software foundation
    
      this program is free software you can redistribute it and or modify
      it under the terms of the gnu general public license version 2 as
      published by the free software foundation #
    
    extracted by the scancode license scanner the SPDX license identifier
    
      GPL-2.0-only
    
    has been chosen to replace the boilerplate/reference in 4122 file(s).
    
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Reviewed-by: Enrico Weigelt <info@metux.net>
    Reviewed-by: Kate Stewart <kstewart@linuxfoundation.org>
    Reviewed-by: Allison Randal <allison@lohutok.net>
    Cc: linux-spdx@vger.kernel.org
    Link: https://lkml.kernel.org/r/20190604081206.933168790@linutronix.de
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/include/linux/pda_power.h b/include/linux/pda_power.h
index 2bb62bf296ac..2a69db4b60b7 100644
--- a/include/linux/pda_power.h
+++ b/include/linux/pda_power.h
@@ -1,13 +1,10 @@
+/* SPDX-License-Identifier: GPL-2.0-only */
 /*
  * Common power driver for PDAs and phones with one or two external
  * power supplies (AC/USB) connected to main and backup batteries,
  * and optional builtin charger.
  *
  * Copyright © 2007 Anton Vorontsov <cbou@mail.ru>
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License version 2 as
- * published by the Free Software Foundation.
  */
 
 #ifndef __PDA_POWER_H__

commit 9ad63986c606c60e2e916b1b96f22991f966d9cc
Author: Dima Zavin <dima@android.com>
Date:   Sun Jul 10 16:01:15 2011 -0700

    pda_power: Add support for using otg transceiver events
    
    If the platform data sets the use_otg_notifier flag,
    the driver will now register an otg notifier callback and listen
    to transceiver events for AC/USB plug-in events instead. This would
    normally be used by not specifying is_xx_online callbacks and
    not specifying any irqs so the state machine is completely driven
    from OTG xceiver events.
    
    Signed-off-by: Dima Zavin <dima@android.com>
    Signed-off-by: Anton Vorontsov <cbouatmailru@gmail.com>

diff --git a/include/linux/pda_power.h b/include/linux/pda_power.h
index c9e4d814ff77..2bb62bf296ac 100644
--- a/include/linux/pda_power.h
+++ b/include/linux/pda_power.h
@@ -35,6 +35,8 @@ struct pda_power_pdata {
 	unsigned int polling_interval; /* msecs, default is 2000 */
 
 	unsigned long ac_max_uA; /* current to draw when on AC */
+
+	bool use_otg_notifier;
 };
 
 #endif /* __PDA_POWER_H__ */

commit a3bcbbee83f55cbaec9b2ad748e7300c7feb2192
Author: Daniel Mack <daniel@caiaq.de>
Date:   Mon Apr 12 23:33:22 2010 +0200

    pda_power: Add function callbacks for suspend and resume
    
    Add function prototypes for power management events so they can be
    handled and used by platform implementations.
    
    Signed-off-by: Daniel Mack <daniel@caiaq.de>
    Cc: Dmitry Baryshkov <dbaryshkov@gmail.com>
    Cc: David Woodhouse <dwmw2@infradead.org>
    Signed-off-by: Anton Vorontsov <cbouatmailru@gmail.com>

diff --git a/include/linux/pda_power.h b/include/linux/pda_power.h
index d4cf7a2ceb3e..c9e4d814ff77 100644
--- a/include/linux/pda_power.h
+++ b/include/linux/pda_power.h
@@ -24,6 +24,8 @@ struct pda_power_pdata {
 	int (*is_usb_online)(void);
 	void (*set_charge)(int flags);
 	void (*exit)(struct device *dev);
+	int (*suspend)(pm_message_t state);
+	int (*resume)(void);
 
 	char **supplied_to;
 	size_t num_supplicants;

commit 5bf2b994bfe11bfe86231050897b2d881ca544d9
Author: Philipp Zabel <philipp.zabel@gmail.com>
Date:   Sun Jan 18 17:40:27 2009 +0100

    pda_power: Add optional OTG transceiver and voltage regulator support
    
    This patch allows machines to use an OTG transceiver driver instead of
    supplying a custom is_usb_online callback to check USB power.
    Also, in the case that the OTG transceiver handles charger control when
    connected to USB, a regulator named "ac_draw" can be supplied instead of
    the custom set_charge callback to control the charger when connected to
    AC.
    
    The check for (transceiver->state == OTG_STATE_B_PERIPHERAL) in
    otg_is_usb_online is probably too simple, I'm just using this with a
    peripheral only device and gpio_vbus + bq24022. I'm not sure which other
    OTG states can supply power.
    
    Signed-off-by: Philipp Zabel <philipp.zabel@gmail.com>
    Signed-off-by: Anton Vorontsov <cbouatmailru@gmail.com>

diff --git a/include/linux/pda_power.h b/include/linux/pda_power.h
index cb7d10f30763..d4cf7a2ceb3e 100644
--- a/include/linux/pda_power.h
+++ b/include/linux/pda_power.h
@@ -31,6 +31,8 @@ struct pda_power_pdata {
 	unsigned int wait_for_status; /* msecs, default is 500 */
 	unsigned int wait_for_charger; /* msecs, default is 500 */
 	unsigned int polling_interval; /* msecs, default is 2000 */
+
+	unsigned long ac_max_uA; /* current to draw when on AC */
 };
 
 #endif /* __PDA_POWER_H__ */

commit f6b6b180b4614e57af217045f71caedd94821fc7
Author: Philipp Zabel <philipp.zabel@gmail.com>
Date:   Sat Apr 12 13:47:45 2008 +0200

    pda_power: add init and exit function callbacks
    
    This adds init/exit function callbacks to pda_power, to
    provide a place where the platform code can request/free
    GPIOs that it wants to use in the is_ac_online, is_usb_online
    and set_charge functions.
    
    Signed-off-by: Philipp Zabel <philipp.zabel@gmail.com>
    Signed-off-by: Anton Vorontsov <cbouatmailru@gmail.com>

diff --git a/include/linux/pda_power.h b/include/linux/pda_power.h
index 225beb136807..cb7d10f30763 100644
--- a/include/linux/pda_power.h
+++ b/include/linux/pda_power.h
@@ -16,10 +16,14 @@
 #define PDA_POWER_CHARGE_AC  (1 << 0)
 #define PDA_POWER_CHARGE_USB (1 << 1)
 
+struct device;
+
 struct pda_power_pdata {
+	int (*init)(struct device *dev);
 	int (*is_ac_online)(void);
 	int (*is_usb_online)(void);
 	void (*set_charge)(int flags);
+	void (*exit)(struct device *dev);
 
 	char **supplied_to;
 	size_t num_supplicants;

commit c3caebad7427f62fe77621bae1bd1da0e56a130d
Author: Anton Vorontsov <cbouatmailru@gmail.com>
Date:   Sun Jan 13 02:44:20 2008 +0300

    pda_power: implement polling
    
    Signed-off-by: Anton Vorontsov <cbou@mail.ru>

diff --git a/include/linux/pda_power.h b/include/linux/pda_power.h
index 1375f15797e7..225beb136807 100644
--- a/include/linux/pda_power.h
+++ b/include/linux/pda_power.h
@@ -26,6 +26,7 @@ struct pda_power_pdata {
 
 	unsigned int wait_for_status; /* msecs, default is 500 */
 	unsigned int wait_for_charger; /* msecs, default is 500 */
+	unsigned int polling_interval; /* msecs, default is 2000 */
 };
 
 #endif /* __PDA_POWER_H__ */

commit b2998049cfae4f4a81c4bb048814d34912017bb9
Author: Anton Vorontsov <cbou@mail.ru>
Date:   Fri May 4 00:32:17 2007 +0400

    [BATTERY] pda_power platform driver
    
    Common power driver for PDAs and phones with one or two external
    power supplies (AC/USB) connected to main and backup batteries,
    and optional builtin charger.
    
    It's used to stop logic duplication through different embedded
    devices. So, power supply *logic* is here. pda_power register
    power supplies, and will take care about notifying batteries
    about power changes through external power interface.
    
    Currently, power consumption legal limits (including USB power
    consumption) should be handled by platform code, inside set_charge
    function.
    
    Signed-off-by: Anton Vorontsov <cbou@mail.ru>
    Signed-off-by: Roman Moravcik <roman.moravcik@gmail.com>
    Signed-off-by: David Woodhouse <dwmw2@infradead.org>

diff --git a/include/linux/pda_power.h b/include/linux/pda_power.h
new file mode 100644
index 000000000000..1375f15797e7
--- /dev/null
+++ b/include/linux/pda_power.h
@@ -0,0 +1,31 @@
+/*
+ * Common power driver for PDAs and phones with one or two external
+ * power supplies (AC/USB) connected to main and backup batteries,
+ * and optional builtin charger.
+ *
+ * Copyright © 2007 Anton Vorontsov <cbou@mail.ru>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ */
+
+#ifndef __PDA_POWER_H__
+#define __PDA_POWER_H__
+
+#define PDA_POWER_CHARGE_AC  (1 << 0)
+#define PDA_POWER_CHARGE_USB (1 << 1)
+
+struct pda_power_pdata {
+	int (*is_ac_online)(void);
+	int (*is_usb_online)(void);
+	void (*set_charge)(int flags);
+
+	char **supplied_to;
+	size_t num_supplicants;
+
+	unsigned int wait_for_status; /* msecs, default is 500 */
+	unsigned int wait_for_charger; /* msecs, default is 500 */
+};
+
+#endif /* __PDA_POWER_H__ */
