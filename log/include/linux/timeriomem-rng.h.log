commit 2ef540476e0077ca2f9992fde9a014891000c4b5
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Mon Jul 29 00:32:36 2019 +0900

    hwrng: timeriomem - add include guard to timeriomem-rng.h
    
    Add a header include guard just in case.
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

diff --git a/include/linux/timeriomem-rng.h b/include/linux/timeriomem-rng.h
index fd4a6e6ec831..672df7fbf6c1 100644
--- a/include/linux/timeriomem-rng.h
+++ b/include/linux/timeriomem-rng.h
@@ -5,6 +5,9 @@
  * Copyright (c) 2009 Alexander Clouter <alex@digriz.org.uk>
  */
 
+#ifndef _LINUX_TIMERIOMEM_RNG_H
+#define _LINUX_TIMERIOMEM_RNG_H
+
 struct timeriomem_rng_data {
 	void __iomem		*address;
 
@@ -14,3 +17,5 @@ struct timeriomem_rng_data {
 	/* bits of entropy per 1024 bits read */
 	unsigned int		quality;
 };
+
+#endif /* _LINUX_TIMERIOMEM_RNG_H */

commit d2912cb15bdda8ba4a5dd73396ad62641af2f520
Author: Thomas Gleixner <tglx@linutronix.de>
Date:   Tue Jun 4 10:11:33 2019 +0200

    treewide: Replace GPLv2 boilerplate/reference with SPDX - rule 500
    
    Based on 2 normalized pattern(s):
    
      this program is free software you can redistribute it and or modify
      it under the terms of the gnu general public license version 2 as
      published by the free software foundation
    
      this program is free software you can redistribute it and or modify
      it under the terms of the gnu general public license version 2 as
      published by the free software foundation #
    
    extracted by the scancode license scanner the SPDX license identifier
    
      GPL-2.0-only
    
    has been chosen to replace the boilerplate/reference in 4122 file(s).
    
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Reviewed-by: Enrico Weigelt <info@metux.net>
    Reviewed-by: Kate Stewart <kstewart@linuxfoundation.org>
    Reviewed-by: Allison Randal <allison@lohutok.net>
    Cc: linux-spdx@vger.kernel.org
    Link: https://lkml.kernel.org/r/20190604081206.933168790@linutronix.de
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/include/linux/timeriomem-rng.h b/include/linux/timeriomem-rng.h
index 3e00122bcf88..fd4a6e6ec831 100644
--- a/include/linux/timeriomem-rng.h
+++ b/include/linux/timeriomem-rng.h
@@ -1,11 +1,8 @@
+/* SPDX-License-Identifier: GPL-2.0-only */
 /*
  * linux/include/linux/timeriomem-rng.h
  *
  * Copyright (c) 2009 Alexander Clouter <alex@digriz.org.uk>
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License version 2 as
- * published by the Free Software Foundation.
  */
 
 struct timeriomem_rng_data {

commit 284e76387c38260e834c99b010a68d75fc46b394
Author: Rick Altherr <raltherr@google.com>
Date:   Mon May 22 14:12:24 2017 -0700

    hw_random: timeriomem_rng: Allow setting RNG quality from platform data
    
    When a hw_random device's quality is non-zero, it will automatically be
    used to fill the kernel's entropy pool.  Since timeriomem_rng is used by
    many different devices, the quality needs to be provided by platform
    data or device tree.
    
    Signed-off-by: Rick Altherr <raltherr@google.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

diff --git a/include/linux/timeriomem-rng.h b/include/linux/timeriomem-rng.h
index 46eb27ddbfab..3e00122bcf88 100644
--- a/include/linux/timeriomem-rng.h
+++ b/include/linux/timeriomem-rng.h
@@ -13,4 +13,7 @@ struct timeriomem_rng_data {
 
 	/* measures in usecs */
 	unsigned int		period;
+
+	/* bits of entropy per 1024 bits read */
+	unsigned int		quality;
 };

commit 1907da78bf6a3f74e5d030a4a4f6700ba0d0a234
Author: Alexander Clouter <alex@digriz.org.uk>
Date:   Sun Mar 31 17:34:50 2013 +0100

    hwrng: timeriomem - update to support more than one device
    
    timeriomem_rng only supports a single device instance.  This patch
    enables multiple timeriomem_rng devices to coexist as well as adds
    some additional error checking.
    
    Signed-off-by: Alexander Clouter <alex@digriz.org.uk>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

diff --git a/include/linux/timeriomem-rng.h b/include/linux/timeriomem-rng.h
index 3e08a1c86830..46eb27ddbfab 100644
--- a/include/linux/timeriomem-rng.h
+++ b/include/linux/timeriomem-rng.h
@@ -8,12 +8,7 @@
  * published by the Free Software Foundation.
  */
 
-#include <linux/completion.h>
-
 struct timeriomem_rng_data {
-	struct completion	completion;
-	unsigned int		present:1;
-
 	void __iomem		*address;
 
 	/* measures in usecs */

commit 3341323bb4c198f704cffbfdda37bcec1226ef7d
Author: Alexander Clouter <alex@digriz.org.uk>
Date:   Fri Mar 27 12:59:54 2009 +0800

    hwrng: timeriomem - Use phys address rather than virt
    
    There is no ioremap'ing or anything in timeriomem-rng.c as I foolishly
    used already remapped virtual addresses instead of passing the physical
    address to be polled.
    
    This patch fixes this flaw and lets developers do the Right Thing(tm).
    
    Signed-off-by: Alexander Clouter <alex@digriz.org.uk>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

diff --git a/include/linux/timeriomem-rng.h b/include/linux/timeriomem-rng.h
index dd253177f65f..3e08a1c86830 100644
--- a/include/linux/timeriomem-rng.h
+++ b/include/linux/timeriomem-rng.h
@@ -14,7 +14,7 @@ struct timeriomem_rng_data {
 	struct completion	completion;
 	unsigned int		present:1;
 
-	u32 __iomem		*address;
+	void __iomem		*address;
 
 	/* measures in usecs */
 	unsigned int		period;

commit 9c3c133b1ed6e6d01bfabb6de29bf3d0f0886354
Author: Alexander Clouter <alex@digriz.org.uk>
Date:   Sun Feb 22 12:03:56 2009 +0800

    hwrng: timeriomem - New driver
    
    Some hardware platforms, the TS-7800[1] is one for example, can
    supply the kernel with an entropy source, albeit a slow one for
    TS-7800 users, by just reading a particular IO address.  This
    source must not be read above a certain rate otherwise the quality
    suffers.
    
    The driver is then hooked into by calling
    platform_device_(register|add|del) passing a structure similar to:
    ------
    static struct timeriomem_rng_data ts78xx_ts_rng_data = {
            .address        = (u32 *__iomem) TS_RNG,
            .period         = 1000000, /* one second */
    };
    
    static struct platform_device ts78xx_ts_rng_device = {
            .name           = "timeriomem_rng",
            .id             = -1,
            .dev            = {
                    .platform_data  = &ts78xx_ts_rng_data,
            },
            .num_resources  = 0,
    };
    ------
    
    [1] http://www.embeddedarm.com/products/board-detail.php?product=TS-7800
    
    Signed-off-by: Alexander Clouter <alex@digriz.org.uk>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

diff --git a/include/linux/timeriomem-rng.h b/include/linux/timeriomem-rng.h
new file mode 100644
index 000000000000..dd253177f65f
--- /dev/null
+++ b/include/linux/timeriomem-rng.h
@@ -0,0 +1,21 @@
+/*
+ * linux/include/linux/timeriomem-rng.h
+ *
+ * Copyright (c) 2009 Alexander Clouter <alex@digriz.org.uk>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ */
+
+#include <linux/completion.h>
+
+struct timeriomem_rng_data {
+	struct completion	completion;
+	unsigned int		present:1;
+
+	u32 __iomem		*address;
+
+	/* measures in usecs */
+	unsigned int		period;
+};
