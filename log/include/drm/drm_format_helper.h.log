commit 2874c5fd284268364ece81a7bd936f3c8168e567
Author: Thomas Gleixner <tglx@linutronix.de>
Date:   Mon May 27 08:55:01 2019 +0200

    treewide: Replace GPLv2 boilerplate/reference with SPDX - rule 152
    
    Based on 1 normalized pattern(s):
    
      this program is free software you can redistribute it and or modify
      it under the terms of the gnu general public license as published by
      the free software foundation either version 2 of the license or at
      your option any later version
    
    extracted by the scancode license scanner the SPDX license identifier
    
      GPL-2.0-or-later
    
    has been chosen to replace the boilerplate/reference in 3029 file(s).
    
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Reviewed-by: Allison Randal <allison@lohutok.net>
    Cc: linux-spdx@vger.kernel.org
    Link: https://lkml.kernel.org/r/20190527070032.746973796@linutronix.de
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/include/drm/drm_format_helper.h b/include/drm/drm_format_helper.h
index 085d63faee12..ac220aa1a245 100644
--- a/include/drm/drm_format_helper.h
+++ b/include/drm/drm_format_helper.h
@@ -1,10 +1,6 @@
+/* SPDX-License-Identifier: GPL-2.0-or-later */
 /*
  * Copyright (C) 2016 Noralf Trønnes
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
  */
 
 #ifndef __LINUX_DRM_FORMAT_HELPER_H

commit 5c5373b51becbabb16390a5689722a7efd4600b2
Author: Gerd Hoffmann <kraxel@redhat.com>
Date:   Wed Apr 10 08:38:15 2019 +0200

    drm: switch drm_fb_xrgb8888_to_rgb888_dstclip to accept __iomem dst
    
    Not all archs have the __io_virt() macro, so cirrus can't simply convert
    pointers that way.  The drm format helpers have to use memcpy_toio()
    instead.
    
    This patch makes drm_fb_xrgb8888_to_rgb888_dstclip() accept a __iomem
    dst pointer and use memcpy_toio() instead of memcpy().  The helper
    function (drm_fb_xrgb8888_to_rgb888_line) has been changed to process a
    single scanline.
    
    Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
    Reviewed-by: Noralf Trønnes <noralf@tronnes.org>
    Link: http://patchwork.freedesktop.org/patch/msgid/20190410063815.17062-4-kraxel@redhat.com

diff --git a/include/drm/drm_format_helper.h b/include/drm/drm_format_helper.h
index 490e9a06c910..085d63faee12 100644
--- a/include/drm/drm_format_helper.h
+++ b/include/drm/drm_format_helper.h
@@ -26,7 +26,7 @@ void drm_fb_xrgb8888_to_rgb565(void *dst, void *vaddr,
 void drm_fb_xrgb8888_to_rgb565_dstclip(void __iomem *dst, unsigned int dst_pitch,
 				       void *vaddr, struct drm_framebuffer *fb,
 				       struct drm_rect *clip, bool swab);
-void drm_fb_xrgb8888_to_rgb888_dstclip(void *dst, unsigned int dst_pitch,
+void drm_fb_xrgb8888_to_rgb888_dstclip(void __iomem *dst, unsigned int dst_pitch,
 				       void *vaddr, struct drm_framebuffer *fb,
 				       struct drm_rect *clip);
 void drm_fb_xrgb8888_to_gray8(u8 *dst, void *vaddr, struct drm_framebuffer *fb,

commit d653bd394823772f0696c0642be94d78d5562e41
Author: Gerd Hoffmann <kraxel@redhat.com>
Date:   Wed Apr 10 08:38:14 2019 +0200

    drm: switch drm_fb_xrgb8888_to_rgb565_dstclip to accept __iomem dst
    
    Not all archs have the __io_virt() macro, so cirrus can't simply convert
    pointers that way.  The drm format helpers have to use memcpy_toio()
    instead.
    
    This patch makes drm_fb_xrgb8888_to_rgb565_dstclip() accept a __iomem
    dst pointer and use memcpy_toio() instead of memcpy().  The helper
    function (drm_fb_xrgb8888_to_rgb565_line) has been changed to process
    a single scanline.
    
    Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
    Reviewed-by: Noralf Trønnes <noralf@tronnes.org>
    Link: http://patchwork.freedesktop.org/patch/msgid/20190410063815.17062-3-kraxel@redhat.com

diff --git a/include/drm/drm_format_helper.h b/include/drm/drm_format_helper.h
index bc2e1004e166..490e9a06c910 100644
--- a/include/drm/drm_format_helper.h
+++ b/include/drm/drm_format_helper.h
@@ -22,10 +22,10 @@ void drm_fb_swab16(u16 *dst, void *vaddr, struct drm_framebuffer *fb,
 		   struct drm_rect *clip);
 void drm_fb_xrgb8888_to_rgb565(void *dst, void *vaddr,
 			       struct drm_framebuffer *fb,
-			       struct drm_rect *clip, bool swap);
-void drm_fb_xrgb8888_to_rgb565_dstclip(void *dst, unsigned int dst_pitch,
+			       struct drm_rect *clip, bool swab);
+void drm_fb_xrgb8888_to_rgb565_dstclip(void __iomem *dst, unsigned int dst_pitch,
 				       void *vaddr, struct drm_framebuffer *fb,
-				       struct drm_rect *clip, bool swap);
+				       struct drm_rect *clip, bool swab);
 void drm_fb_xrgb8888_to_rgb888_dstclip(void *dst, unsigned int dst_pitch,
 				       void *vaddr, struct drm_framebuffer *fb,
 				       struct drm_rect *clip);

commit bf4f6d16c89466bbbe2f9c959a5ae366856f3111
Author: Gerd Hoffmann <kraxel@redhat.com>
Date:   Wed Apr 10 08:38:13 2019 +0200

    drm: switch drm_fb_memcpy_dstclip to accept __iomem dst
    
    Not all archs have the __io_virt() macro, so cirrus can't simply convert
    pointers that way.  The drm format helpers have to use memcpy_toio()
    instead.
    
    This patch makes drm_fb_memcpy_dstclip() accept a __iomem dst pointer
    and use memcpy_toio() instead of memcpy().  With that separating out the
    memcpy loop into the drm_fb_memcpy_lines() helper isn't useful any more,
    so move the code back into the calling functins.
    
    Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
    Reviewed-by: Noralf Trønnes <noralf@tronnes.org>
    Link: http://patchwork.freedesktop.org/patch/msgid/20190410063815.17062-2-kraxel@redhat.com

diff --git a/include/drm/drm_format_helper.h b/include/drm/drm_format_helper.h
index 6f84380757ee..bc2e1004e166 100644
--- a/include/drm/drm_format_helper.h
+++ b/include/drm/drm_format_helper.h
@@ -15,7 +15,8 @@ struct drm_rect;
 
 void drm_fb_memcpy(void *dst, void *vaddr, struct drm_framebuffer *fb,
 		   struct drm_rect *clip);
-void drm_fb_memcpy_dstclip(void *dst, void *vaddr, struct drm_framebuffer *fb,
+void drm_fb_memcpy_dstclip(void __iomem *dst, void *vaddr,
+			   struct drm_framebuffer *fb,
 			   struct drm_rect *clip);
 void drm_fb_swab16(u16 *dst, void *vaddr, struct drm_framebuffer *fb,
 		   struct drm_rect *clip);

commit ec3de7a43e9cac8a2dc1fce069321cb9538f0b34
Author: Gerd Hoffmann <kraxel@redhat.com>
Date:   Fri Apr 5 11:52:18 2019 +0200

    drm: add drm_fb_xrgb8888_to_rgb888_dstclip()
    
    Simliar to drm_fb_xrgb8888_to_rgb565_dstclip() but converts to rgb888
    instead of rgb565.
    
    Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
    Reviewed-by: Noralf Trønnes <noralf@tronnes.org>
    Link: http://patchwork.freedesktop.org/patch/msgid/20190405095219.9231-5-kraxel@redhat.com

diff --git a/include/drm/drm_format_helper.h b/include/drm/drm_format_helper.h
index a84d71fa446b..6f84380757ee 100644
--- a/include/drm/drm_format_helper.h
+++ b/include/drm/drm_format_helper.h
@@ -25,6 +25,9 @@ void drm_fb_xrgb8888_to_rgb565(void *dst, void *vaddr,
 void drm_fb_xrgb8888_to_rgb565_dstclip(void *dst, unsigned int dst_pitch,
 				       void *vaddr, struct drm_framebuffer *fb,
 				       struct drm_rect *clip, bool swap);
+void drm_fb_xrgb8888_to_rgb888_dstclip(void *dst, unsigned int dst_pitch,
+				       void *vaddr, struct drm_framebuffer *fb,
+				       struct drm_rect *clip);
 void drm_fb_xrgb8888_to_gray8(u8 *dst, void *vaddr, struct drm_framebuffer *fb,
 			      struct drm_rect *clip);
 

commit bcc4442008aca0e1566b7367f51670143d1ea7bf
Author: Gerd Hoffmann <kraxel@redhat.com>
Date:   Fri Apr 5 11:52:17 2019 +0200

    drm: add drm_fb_xrgb8888_to_rgb565_dstclip()
    
    It is a drm_fb_xrgb8888_to_rgb565() variant which checks the clip
    rectangle for the destination too.
    
    Common code between drm_fb_xrgb8888_to_rgb565() and
    drm_fb_xrgb8888_to_rgb565_dstclip() was factored out into the
    drm_fb_xrgb8888_to_rgb565_lines() helper function.
    
    Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
    Reviewed-by: Noralf Trønnes <noralf@tronnes.org>
    Link: http://patchwork.freedesktop.org/patch/msgid/20190405095219.9231-4-kraxel@redhat.com

diff --git a/include/drm/drm_format_helper.h b/include/drm/drm_format_helper.h
index c52b7b9a25f0..a84d71fa446b 100644
--- a/include/drm/drm_format_helper.h
+++ b/include/drm/drm_format_helper.h
@@ -19,9 +19,12 @@ void drm_fb_memcpy_dstclip(void *dst, void *vaddr, struct drm_framebuffer *fb,
 			   struct drm_rect *clip);
 void drm_fb_swab16(u16 *dst, void *vaddr, struct drm_framebuffer *fb,
 		   struct drm_rect *clip);
-void drm_fb_xrgb8888_to_rgb565(u16 *dst, void *vaddr,
+void drm_fb_xrgb8888_to_rgb565(void *dst, void *vaddr,
 			       struct drm_framebuffer *fb,
 			       struct drm_rect *clip, bool swap);
+void drm_fb_xrgb8888_to_rgb565_dstclip(void *dst, unsigned int dst_pitch,
+				       void *vaddr, struct drm_framebuffer *fb,
+				       struct drm_rect *clip, bool swap);
 void drm_fb_xrgb8888_to_gray8(u8 *dst, void *vaddr, struct drm_framebuffer *fb,
 			      struct drm_rect *clip);
 

commit 26f024f54ab69a1012214755223d6ed61dd7bc98
Author: Gerd Hoffmann <kraxel@redhat.com>
Date:   Fri Apr 5 11:52:16 2019 +0200

    drm: add drm_fb_memcpy_dstclip() helper
    
    It is a drm_fb_memcpy() variant which checks the clip rectangle for the
    destination too.
    
    Common code between drm_fb_memcpy() and drm_fb_memcpy_dstclip() was
    factored out into the drm_fb_memcpy_lines() helper function.
    
    Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
    Reviewed-by: Noralf Trønnes <noralf@tronnes.org>
    Link: http://patchwork.freedesktop.org/patch/msgid/20190405095219.9231-3-kraxel@redhat.com

diff --git a/include/drm/drm_format_helper.h b/include/drm/drm_format_helper.h
index 5a7ada6b0bef..c52b7b9a25f0 100644
--- a/include/drm/drm_format_helper.h
+++ b/include/drm/drm_format_helper.h
@@ -15,6 +15,8 @@ struct drm_rect;
 
 void drm_fb_memcpy(void *dst, void *vaddr, struct drm_framebuffer *fb,
 		   struct drm_rect *clip);
+void drm_fb_memcpy_dstclip(void *dst, void *vaddr, struct drm_framebuffer *fb,
+			   struct drm_rect *clip);
 void drm_fb_swab16(u16 *dst, void *vaddr, struct drm_framebuffer *fb,
 		   struct drm_rect *clip);
 void drm_fb_xrgb8888_to_rgb565(u16 *dst, void *vaddr,

commit 7415287e1f3675996a4a6919fe500c30d30951f6
Author: Gerd Hoffmann <kraxel@redhat.com>
Date:   Fri Apr 5 11:52:15 2019 +0200

    drm: move tinydrm format conversion helpers to new drm_format_helper.c
    
    Also rename them from tinydrm_* to drm_fb_*
    Pure code motion, no functional change.
    
    Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
    Reviewed-by: Sam Ravnborg <sam@ravnborg.org>
    Reviewed-by: Noralf Trønnes <noralf@tronnes.org>
    Link: http://patchwork.freedesktop.org/patch/msgid/20190405095219.9231-2-kraxel@redhat.com

diff --git a/include/drm/drm_format_helper.h b/include/drm/drm_format_helper.h
new file mode 100644
index 000000000000..5a7ada6b0bef
--- /dev/null
+++ b/include/drm/drm_format_helper.h
@@ -0,0 +1,26 @@
+/*
+ * Copyright (C) 2016 Noralf Trønnes
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ */
+
+#ifndef __LINUX_DRM_FORMAT_HELPER_H
+#define __LINUX_DRM_FORMAT_HELPER_H
+
+struct drm_framebuffer;
+struct drm_rect;
+
+void drm_fb_memcpy(void *dst, void *vaddr, struct drm_framebuffer *fb,
+		   struct drm_rect *clip);
+void drm_fb_swab16(u16 *dst, void *vaddr, struct drm_framebuffer *fb,
+		   struct drm_rect *clip);
+void drm_fb_xrgb8888_to_rgb565(u16 *dst, void *vaddr,
+			       struct drm_framebuffer *fb,
+			       struct drm_rect *clip, bool swap);
+void drm_fb_xrgb8888_to_gray8(u8 *dst, void *vaddr, struct drm_framebuffer *fb,
+			      struct drm_rect *clip);
+
+#endif /* __LINUX_DRM_FORMAT_HELPER_H */
