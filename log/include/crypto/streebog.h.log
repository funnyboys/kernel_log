commit c5c46887cfe7d0dff743d9eda7c91de625e96960
Author: Eric Biggers <ebiggers@google.com>
Date:   Sun Mar 31 13:04:19 2019 -0700

    crypto: streebog - fix unaligned memory accesses
    
    Don't cast the data buffer directly to streebog_uint512, as this
    violates alignment rules.
    
    Fixes: fe18957e8e87 ("crypto: streebog - add Streebog hash function")
    Cc: Vitaly Chikunov <vt@altlinux.org>
    Signed-off-by: Eric Biggers <ebiggers@google.com>
    Reviewed-by: Vitaly Chikunov <vt@altlinux.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

diff --git a/include/crypto/streebog.h b/include/crypto/streebog.h
index 856e32af8657..cae1b4a01971 100644
--- a/include/crypto/streebog.h
+++ b/include/crypto/streebog.h
@@ -23,7 +23,10 @@ struct streebog_uint512 {
 };
 
 struct streebog_state {
-	u8 buffer[STREEBOG_BLOCK_SIZE];
+	union {
+		u8 buffer[STREEBOG_BLOCK_SIZE];
+		struct streebog_uint512 m;
+	};
 	struct streebog_uint512 hash;
 	struct streebog_uint512 h;
 	struct streebog_uint512 N;

commit 73381da5f9ec333b1fbe38a156e7764a90e36a74
Author: Eric Biggers <ebiggers@google.com>
Date:   Thu Jan 10 12:17:54 2019 -0800

    crypto: streebog - use correct endianness type
    
    streebog_uint512::qword needs to be __le64, not u64.  This fixes a large
    number of sparse warnings:
    
        crypto/streebog_generic.c:25:9: warning: incorrect type in initializer (different base types)
        crypto/streebog_generic.c:25:9:    expected unsigned long long
        crypto/streebog_generic.c:25:9:    got restricted __le64 [usertype]
        [omitted many similar warnings]
    
    No actual change in behavior.
    
    Cc: Vitaly Chikunov <vt@altlinux.org>
    Signed-off-by: Eric Biggers <ebiggers@google.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

diff --git a/include/crypto/streebog.h b/include/crypto/streebog.h
index 4af119f7e07b..856e32af8657 100644
--- a/include/crypto/streebog.h
+++ b/include/crypto/streebog.h
@@ -19,7 +19,7 @@
 #define STREEBOG_BLOCK_SIZE	64
 
 struct streebog_uint512 {
-	u64 qword[8];
+	__le64 qword[8];
 };
 
 struct streebog_state {

commit fe18957e8e87403a9d4be8e8a62352ef107def99
Author: Vitaly Chikunov <vt@altlinux.org>
Date:   Wed Nov 7 00:00:01 2018 +0300

    crypto: streebog - add Streebog hash function
    
    Add GOST/IETF Streebog hash function (GOST R 34.11-2012, RFC 6986)
    generic hash transformation.
    
    Cc: linux-integrity@vger.kernel.org
    Signed-off-by: Vitaly Chikunov <vt@altlinux.org>
    Reviewed-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

diff --git a/include/crypto/streebog.h b/include/crypto/streebog.h
new file mode 100644
index 000000000000..4af119f7e07b
--- /dev/null
+++ b/include/crypto/streebog.h
@@ -0,0 +1,34 @@
+/* SPDX-License-Identifier: GPL-2.0+ OR BSD-2-Clause */
+/*
+ * Copyright (c) 2013 Alexey Degtyarev <alexey@renatasystems.org>
+ * Copyright (c) 2018 Vitaly Chikunov <vt@altlinux.org>
+ *
+ * This program is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU General Public License as published by the Free
+ * Software Foundation; either version 2 of the License, or (at your option)
+ * any later version.
+ */
+
+#ifndef _CRYPTO_STREEBOG_H_
+#define _CRYPTO_STREEBOG_H_
+
+#include <linux/types.h>
+
+#define STREEBOG256_DIGEST_SIZE	32
+#define STREEBOG512_DIGEST_SIZE	64
+#define STREEBOG_BLOCK_SIZE	64
+
+struct streebog_uint512 {
+	u64 qword[8];
+};
+
+struct streebog_state {
+	u8 buffer[STREEBOG_BLOCK_SIZE];
+	struct streebog_uint512 hash;
+	struct streebog_uint512 h;
+	struct streebog_uint512 N;
+	struct streebog_uint512 Sigma;
+	size_t fillsize;
+};
+
+#endif /* !_CRYPTO_STREEBOG_H_ */
