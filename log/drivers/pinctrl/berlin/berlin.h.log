commit c6114f21e2a2950ced2a4601189f0b4c961d5833
Author: Jisheng Zhang <Jisheng.Zhang@synaptics.com>
Date:   Wed May 16 15:33:37 2018 +0800

    pinctrl: berlin: switch to SPDX license identifier
    
    Use the appropriate SPDX license identifier in the berlin pinctrl
    driver source file and drop the previous license text.
    
    Signed-off-by: Jisheng Zhang <Jisheng.Zhang@synaptics.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

diff --git a/drivers/pinctrl/berlin/berlin.h b/drivers/pinctrl/berlin/berlin.h
index e9b30f95b03e..d7787754d1ed 100644
--- a/drivers/pinctrl/berlin/berlin.h
+++ b/drivers/pinctrl/berlin/berlin.h
@@ -1,13 +1,10 @@
+/* SPDX-License-Identifier: GPL-2.0 */
 /*
  * Marvell Berlin SoC pinctrl driver.
  *
  * Copyright (C) 2014 Marvell Technology Group Ltd.
  *
  * Antoine Ténart <antoine.tenart@free-electrons.com>
- *
- * This file is licensed under the terms of the GNU General Public
- * License version 2. This program is licensed "as is" without any
- * warranty of any kind, whether express or implied.
  */
 
 #ifndef __PINCTRL_BERLIN_H

commit 1d48fb6e4aeec5946574712c512c12a053ce82c0
Author: Antoine Ténart <antoine.tenart@free-electrons.com>
Date:   Tue Oct 13 23:31:41 2015 +0200

    pinctrl: berlin: fix my family name spelling
    
    My family name contained an accent when I submitted the
    Berlin pinctrl series in the first place. There was an
    encoding issue when the series was applied. Fix this.
    
    Signed-off-by: Antoine Ténart <antoine.tenart@free-electrons.com>
    Acked-by: Sebastian Hesselbarth <sebastian.hesselbarth@gmail.com>
    [Je me rendis tous les accents aigus]
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

diff --git a/drivers/pinctrl/berlin/berlin.h b/drivers/pinctrl/berlin/berlin.h
index dabbd2aeaf82..e9b30f95b03e 100644
--- a/drivers/pinctrl/berlin/berlin.h
+++ b/drivers/pinctrl/berlin/berlin.h
@@ -3,7 +3,7 @@
  *
  * Copyright (C) 2014 Marvell Technology Group Ltd.
  *
- * Antoine TÃ©nart <antoine.tenart@free-electrons.com>
+ * Antoine Ténart <antoine.tenart@free-electrons.com>
  *
  * This file is licensed under the terms of the GNU General Public
  * License version 2. This program is licensed "as is" without any

commit d5c79fcb193ff825e5d5759cdbbb4a16385fb08f
Author: Jisheng Zhang <jszhang@marvell.com>
Date:   Fri Oct 16 15:37:06 2015 +0800

    pinctrl: berlin: introduce berlin_pinctrl_probe_regmap()
    
    This is to prepare for the next berlin4ct support, where we won't use
    simple-mfd any more.
    
    Signed-off-by: Jisheng Zhang <jszhang@marvell.com>
    Acked-by: Sebastian Hesselbarth <sebastian.hesselbarth@gmail.com>
    Acked-by: Antoine Tenart <antoine.tenart@free-electrons.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

diff --git a/drivers/pinctrl/berlin/berlin.h b/drivers/pinctrl/berlin/berlin.h
index e1aa84145194..dabbd2aeaf82 100644
--- a/drivers/pinctrl/berlin/berlin.h
+++ b/drivers/pinctrl/berlin/berlin.h
@@ -58,4 +58,8 @@ struct berlin_pinctrl_function {
 int berlin_pinctrl_probe(struct platform_device *pdev,
 			 const struct berlin_pinctrl_desc *desc);
 
+int berlin_pinctrl_probe_regmap(struct platform_device *pdev,
+				const struct berlin_pinctrl_desc *desc,
+				struct regmap *regmap);
+
 #endif /* __PINCTRL_BERLIN_H */

commit 3de68d331c24e8136da147801c2d090c3038eb32
Author: Antoine Tenart <antoine.tenart@free-electrons.com>
Date:   Mon May 19 19:36:29 2014 +0200

    pinctrl: berlin: add the core pinctrl driver for Marvell Berlin SoCs
    
    The Marvell Berlin boards have a group based pinmuxing mechanism. This
    adds the core driver support. We actually do not need any information
    about the pins here and only have the definition of the groups.
    
    Let's take the example of the uart0 pinmuxing on the BG2Q. Balls BK4 and
    BH6 are muxed to respectively UART0 RX and TX if the group GSM12 is set
    to mode 0:
    
    Group   Modes   Offset Base     Offset  LSB     Bit Width
    GSM12   3       sm_base         0x40    0x10    0x2
    
    Ball    Group   Mode 0          Mode 1          Mode 2
    BK4     GSM12   UART0_RX        IrDA0_RX        GPIO9
    BH6     GSM12   UART0_TX        IrDA0_TX        GPIO10
    
    So in order to configure BK4 -> UART0_TX and BH6 -> UART0_RX, we need
    to set (sm_base + 0x40 + 0x10) &= ff3fffff.
    
    As pin control registers are part of either chip control or system
    control registers, that deal with a bunch of other functions we rely
    on a regmap instead of exclusively remapping any resources.
    
    Signed-off-by: Antoine Tenart <antoine.tenart@free-electrons.com>
    Acked-by: Sebastian Hesselbarth <sebastian.hesselbarth@gmail.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

diff --git a/drivers/pinctrl/berlin/berlin.h b/drivers/pinctrl/berlin/berlin.h
new file mode 100644
index 000000000000..e1aa84145194
--- /dev/null
+++ b/drivers/pinctrl/berlin/berlin.h
@@ -0,0 +1,61 @@
+/*
+ * Marvell Berlin SoC pinctrl driver.
+ *
+ * Copyright (C) 2014 Marvell Technology Group Ltd.
+ *
+ * Antoine TÃ©nart <antoine.tenart@free-electrons.com>
+ *
+ * This file is licensed under the terms of the GNU General Public
+ * License version 2. This program is licensed "as is" without any
+ * warranty of any kind, whether express or implied.
+ */
+
+#ifndef __PINCTRL_BERLIN_H
+#define __PINCTRL_BERLIN_H
+
+struct berlin_desc_function {
+	const char	*name;
+	u8		muxval;
+};
+
+struct berlin_desc_group {
+	const char			*name;
+	u8				offset;
+	u8				bit_width;
+	u8				lsb;
+	struct berlin_desc_function	*functions;
+};
+
+struct berlin_pinctrl_desc {
+	const struct berlin_desc_group	*groups;
+	unsigned			ngroups;
+};
+
+struct berlin_pinctrl_function {
+	const char	*name;
+	const char	**groups;
+	unsigned	ngroups;
+};
+
+#define BERLIN_PINCTRL_GROUP(_name, _offset, _width, _lsb, ...)		\
+	{								\
+		.name = _name,						\
+		.offset = _offset,					\
+		.bit_width = _width,					\
+		.lsb = _lsb,						\
+		.functions = (struct berlin_desc_function[]){		\
+			__VA_ARGS__, { } },				\
+	}
+
+#define BERLIN_PINCTRL_FUNCTION(_muxval, _name)		\
+	{						\
+		.name = _name,				\
+		.muxval = _muxval,			\
+	}
+
+#define BERLIN_PINCTRL_FUNCTION_UNKNOWN		{}
+
+int berlin_pinctrl_probe(struct platform_device *pdev,
+			 const struct berlin_pinctrl_desc *desc);
+
+#endif /* __PINCTRL_BERLIN_H */
