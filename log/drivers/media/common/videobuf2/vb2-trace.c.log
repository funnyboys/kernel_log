commit e77c31ed60d1bbf4879b19309f848e0d8f6df504
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Fri Feb 23 04:49:30 2018 -0500

    media: videobuf2: fix build issues with vb2-trace
    
    There was a trouble with vb2-trace: instead of being part of
    VB2 core, it was stored at V4L2 videodev. That was wrong,
    as it doesn't actually belong to V4L2 core.
    
    Now that vb2 is not part of v4l2-core, its trace functions
    should be moved altogether. So, move it to its rightful
    place: at videobuf2-core.
    
    That fixes those errors:
            drivers/media/common/videobuf2/videobuf2-core.o: In function `__read_once_size':
            ./include/linux/compiler.h:183: undefined reference to `__tracepoint_vb2_buf_queue'
            ./include/linux/compiler.h:183: undefined reference to `__tracepoint_vb2_buf_queue'
            ./include/linux/compiler.h:183: undefined reference to `__tracepoint_vb2_buf_done'
            ./include/linux/compiler.h:183: undefined reference to `__tracepoint_vb2_buf_done'
            ./include/linux/compiler.h:183: undefined reference to `__tracepoint_vb2_qbuf'
            ./include/linux/compiler.h:183: undefined reference to `__tracepoint_vb2_qbuf'
            ./include/linux/compiler.h:183: undefined reference to `__tracepoint_vb2_dqbuf'
            ./include/linux/compiler.h:183: undefined reference to `__tracepoint_vb2_dqbuf'
            drivers/media/common/videobuf2/videobuf2-core.o:(__jump_table+0x10): undefined reference to `__tracepoint_vb2_buf_queue'
            drivers/media/common/videobuf2/videobuf2-core.o:(__jump_table+0x28): undefined reference to `__tracepoint_vb2_buf_done'
            drivers/media/common/videobuf2/videobuf2-core.o:(__jump_table+0x40): undefined reference to `__tracepoint_vb2_qbuf'
            drivers/media/common/videobuf2/videobuf2-core.o:(__jump_table+0x58): undefined reference to `__tracepoint_vb2_dqbuf'
    
    Reported-by: kbuild test robot <fengguang.wu@intel.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

diff --git a/drivers/media/common/videobuf2/vb2-trace.c b/drivers/media/common/videobuf2/vb2-trace.c
new file mode 100644
index 000000000000..4c0f39d271f0
--- /dev/null
+++ b/drivers/media/common/videobuf2/vb2-trace.c
@@ -0,0 +1,10 @@
+// SPDX-License-Identifier: GPL-2.0
+#include <media/videobuf2-core.h>
+
+#define CREATE_TRACE_POINTS
+#include <trace/events/vb2.h>
+
+EXPORT_TRACEPOINT_SYMBOL_GPL(vb2_buf_done);
+EXPORT_TRACEPOINT_SYMBOL_GPL(vb2_buf_queue);
+EXPORT_TRACEPOINT_SYMBOL_GPL(vb2_dqbuf);
+EXPORT_TRACEPOINT_SYMBOL_GPL(vb2_qbuf);
