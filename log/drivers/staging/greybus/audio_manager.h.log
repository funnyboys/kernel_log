commit f5e4e5e7ae9cab22d62bc870be78c9daf38ab645
Author: Ioannis Valasakis <code@wizofe.uk>
Date:   Fri Nov 9 13:54:00 2018 +0000

    staging: greybus: correct SPDX License Identifier
    
    Replace SPDX License Identifier comments with C comments.
    Reported by checkpatch.
    
    Signed-off-by: Ioannis Valasakis <code@wizofe.uk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/greybus/audio_manager.h b/drivers/staging/greybus/audio_manager.h
index dcb1a20f5ff1..be605485a8ce 100644
--- a/drivers/staging/greybus/audio_manager.h
+++ b/drivers/staging/greybus/audio_manager.h
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+/* SPDX-License-Identifier: GPL-2.0 */
 /*
  * Greybus operations
  *

commit 863dbc52e7f0e5acd7b4883f3933543a81c474c7
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Tue Nov 7 14:58:42 2017 +0100

    staging: greybus: Remove redundant license text
    
    Now that the SPDX tag is in all greybus files, that identifies the
    license in a specific and legally-defined manner.  So the extra GPL text
    wording can be removed as it is no longer needed at all.
    
    This is done on a quest to remove the 700+ different ways that files in
    the kernel describe the GPL license text.  And there's unneeded stuff
    like the address (sometimes incorrect) for the FSF which is never
    needed.
    
    No copyright headers or other non-license-description text was removed.
    
    Cc: Vaibhav Hiremath <hvaibhav.linux@gmail.com>
    Reviewed-by: Alex Elder <elder@linaro.org>
    Acked-by: Vaibhav Agarwal <vaibhav.sr@gmail.com>
    Acked-by: David Lin <dtwlin@gmail.com>
    Acked-by: Johan Hovold <johan@kernel.org>
    Acked-by: Viresh Kumar <viresh.kumar@linaro.org>
    Acked-by: Mark Greer <mgreer@animalcreek.com>
    Acked-by: Rui Miguel Silva <rmfrfs@gmail.com>
    Acked-by: "Bryan O'Donoghue" <pure.logic@nexus-software.ie>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/greybus/audio_manager.h b/drivers/staging/greybus/audio_manager.h
index 312fa2af1270..dcb1a20f5ff1 100644
--- a/drivers/staging/greybus/audio_manager.h
+++ b/drivers/staging/greybus/audio_manager.h
@@ -3,8 +3,6 @@
  * Greybus operations
  *
  * Copyright 2015-2016 Google Inc.
- *
- * Released under the GPLv2 only.
  */
 
 #ifndef _GB_AUDIO_MANAGER_H_

commit eb50fd3a22c770f36be275295b782f3ea52e3215
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Tue Nov 7 14:58:41 2017 +0100

    staging: greybus: add SPDX identifiers to all greybus driver files
    
    It's good to have SPDX identifiers in all files to make it easier to
    audit the kernel tree for correct licenses.
    
    Update the drivers/staging/greybus files files with the correct SPDX
    license identifier based on the license text in the file itself.  The
    SPDX identifier is a legally binding shorthand, which can be used
    instead of the full boiler plate text.
    
    This work is based on a script and data from Thomas Gleixner, Philippe
    Ombredanne, and Kate Stewart.
    
    Cc: Vaibhav Hiremath <hvaibhav.linux@gmail.com>
    Cc: "Bryan O'Donoghue" <pure.logic@nexus-software.ie>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Cc: Kate Stewart <kstewart@linuxfoundation.org>
    Cc: Philippe Ombredanne <pombredanne@nexb.com>
    Acked-by: Vaibhav Agarwal <vaibhav.sr@gmail.com>
    Acked-by: David Lin <dtwlin@gmail.com>
    Reviewed-by: Alex Elder <elder@linaro.org>
    Acked-by: Johan Hovold <johan@kernel.org>
    Acked-by: Viresh Kumar <viresh.kumar@linaro.org>
    Acked-by: Mark Greer <mgreer@animalcreek.com>
    Acked-by: Rui Miguel Silva <rmfrfs@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/greybus/audio_manager.h b/drivers/staging/greybus/audio_manager.h
index 5ab8f5e0ed3f..312fa2af1270 100644
--- a/drivers/staging/greybus/audio_manager.h
+++ b/drivers/staging/greybus/audio_manager.h
@@ -1,3 +1,4 @@
+// SPDX-License-Identifier: GPL-2.0
 /*
  * Greybus operations
  *

commit 49b9137a6002a06f7e44e59ece9b34fd1e4fca4c
Author: Pankaj Bharadiya <pankaj.bharadiya@gmail.com>
Date:   Mon Oct 17 14:42:36 2016 +0530

    staging: greybus: audio: remove redundant slot field
    
    gb_audio_manager_module_descriptor's intf_id field maintains the
    information about the interface on which module is connected hence
    having an extra slot field is redundant.
    
    Thus remove the slot field and its associated code.
    
    Signed-off-by: Pankaj Bharadiya <pankaj.bharadiya@gmail.com>
    Acked-by: Viresh Kumar <viresh.kumar@linaro.org>
    Reviewed-by: Vaibhav Agarwal <vaibhav.sr@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/greybus/audio_manager.h b/drivers/staging/greybus/audio_manager.h
index 056088eb12fe..5ab8f5e0ed3f 100644
--- a/drivers/staging/greybus/audio_manager.h
+++ b/drivers/staging/greybus/audio_manager.h
@@ -18,7 +18,6 @@
 
 struct gb_audio_manager_module_descriptor {
 	char name[GB_AUDIO_MANAGER_MODULE_NAME_LEN];
-	int slot;
 	int vid;
 	int pid;
 	int intf_id;

commit d0af1bd5f6f44971bea2e45acfe07de629734a3e
Author: Pankaj Bharadiya <pankaj.bharadiya@gmail.com>
Date:   Sun Oct 16 15:29:14 2016 +0530

    staging: greybus: audio: Rename cport with intf_id
    
    gb_audio_manager_module_descriptor's cport field is actually used to
    manage and pass interface id to user space.
    
    Thus rename gb_audio_manager_module_descriptor's 'cport' field and
    few other things to avoid confusion.
    
    Signed-off-by: Pankaj Bharadiya <pankaj.bharadiya@gmail.com>
    Reviewed-by: Vaibhav Agarwal <vaibhav.sr@gmail.com>
    Acked-by: Viresh Kumar <viresh.kumar@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/greybus/audio_manager.h b/drivers/staging/greybus/audio_manager.h
index c4ca09754a6a..056088eb12fe 100644
--- a/drivers/staging/greybus/audio_manager.h
+++ b/drivers/staging/greybus/audio_manager.h
@@ -21,7 +21,7 @@ struct gb_audio_manager_module_descriptor {
 	int slot;
 	int vid;
 	int pid;
-	int cport;
+	int intf_id;
 	unsigned int ip_devices;
 	unsigned int op_devices;
 };

commit a9234bfd6cec4420b5bef29d77dce1f9cb0543e2
Author: Vaibhav Agarwal <vaibhav.agarwal@linaro.org>
Date:   Wed Mar 30 13:23:55 2016 +0530

    greybus: audio_manager: Split device type into i/p & o/p devices
    
    Currently, single field is used to report device type say SPK,
    MIC, HS, HP, etc. However above HAL expects separate fields for
    input & ouput device types.
    
    Signed-off-by: Vaibhav Agarwal <vaibhav.agarwal@linaro.org>
    Reviewed-by: Mark Greer <mgreer@animalcreek.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@google.com>

diff --git a/drivers/staging/greybus/audio_manager.h b/drivers/staging/greybus/audio_manager.h
index 9ca7ac09719e..c4ca09754a6a 100644
--- a/drivers/staging/greybus/audio_manager.h
+++ b/drivers/staging/greybus/audio_manager.h
@@ -22,7 +22,8 @@ struct gb_audio_manager_module_descriptor {
 	int vid;
 	int pid;
 	int cport;
-	unsigned int devices;
+	unsigned int ip_devices;
+	unsigned int op_devices;
 };
 
 struct gb_audio_manager_module {

commit 8db00736d365b75d6af5dfd4a2673a1453fff4b7
Author: Svetlin Ankov <ankov_svetlin@projectara.com>
Date:   Wed Jan 13 14:07:48 2016 -0700

    greybus: audio: Add Audio Manager
    
    This is a simple module that keeps a list of connected GB audio
    modules.
    
    Whenever a device is attached, an appropriate uevent is sent to
    userspace:
    
        UDEV  [4941.803215] add      /kernel/gb_audio_manager/0 (gb_audio_manager)
        ACTION=add
        CPORT=99
        DEVICES=0x10
        DEVPATH=/kernel/gb_audio_manager/0
        NAME=naim
        PID=64
        SEQNUM=1828
        SLOT=2
        SUBSYSTEM=gb_audio_manager
        USEC_INITIALIZED=802416
        VID=128
    
    And whenever removed:
    
        UDEV  [4941.836588] remove   /kernel/gb_audio_manager/0 (gb_audio_manager)
        ACTION=remove
        DEVPATH=/kernel/gb_audio_manager/0
        SEQNUM=1833
        SUBSYSTEM=gb_audio_manager
        USEC_INITIALIZED=835681
    
    The API consists of functions for adding, removing and inspecting
    added device module descriptions (struct gb_audio_module):
    
        int                         gb_audio_manager_add(struct gb_audio_module_descriptor *desc);
        int                         gb_audio_manager_remove(int id);
        int                         gb_audio_manager_remove_all(void);
        struct  gb_audio_module*    gb_audio_manager_get_module(int id);
        void                        gb_audio_manager_put_module(struct gb_audio_module *module);
        int                         gb_audio_manager_dump_module(int id);
        void                        gb_audio_manager_dump_all(void);
    
    Devices can be inspected through sysfs in /sys/kernel/gb_audio_manager/{id}/*
    
    If GB_AUDIO_MANAGER_SYSFS is exported as 'true', managing devices can be done
    via the SYSFS as well. For instance:
    
        echo name=naim slot=2 vid=128 pid=64 cport=99 devices=0x10 > /sys/kernel/gb_audio_manager/add
        echo all > /sys/kernel/gb_audio_manager/dump
        echo 2 > /sys/kernel/gb_audio_manager/dump
        echo 2 > /sys/kernel/gb_audio_manager/remove
    
    Signed-off-by: Svetlin Ankov <ankov_svetlin@projectara.com>
    Signed-off-by: Mark Greer <mgreer@animalcreek.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@google.com>

diff --git a/drivers/staging/greybus/audio_manager.h b/drivers/staging/greybus/audio_manager.h
new file mode 100644
index 000000000000..9ca7ac09719e
--- /dev/null
+++ b/drivers/staging/greybus/audio_manager.h
@@ -0,0 +1,82 @@
+/*
+ * Greybus operations
+ *
+ * Copyright 2015-2016 Google Inc.
+ *
+ * Released under the GPLv2 only.
+ */
+
+#ifndef _GB_AUDIO_MANAGER_H_
+#define _GB_AUDIO_MANAGER_H_
+
+#include <linux/kobject.h>
+#include <linux/list.h>
+
+#define GB_AUDIO_MANAGER_NAME "gb_audio_manager"
+#define GB_AUDIO_MANAGER_MODULE_NAME_LEN 64
+#define GB_AUDIO_MANAGER_MODULE_NAME_LEN_SSCANF "63"
+
+struct gb_audio_manager_module_descriptor {
+	char name[GB_AUDIO_MANAGER_MODULE_NAME_LEN];
+	int slot;
+	int vid;
+	int pid;
+	int cport;
+	unsigned int devices;
+};
+
+struct gb_audio_manager_module {
+	struct kobject kobj;
+	struct list_head list;
+	int id;
+	struct gb_audio_manager_module_descriptor desc;
+};
+
+/*
+ * Creates a new gb_audio_manager_module_descriptor, using the specified
+ * descriptor.
+ *
+ * Returns a negative result on error, or the id of the newly created module.
+ *
+ */
+int gb_audio_manager_add(struct gb_audio_manager_module_descriptor *desc);
+
+/*
+ * Removes a connected gb_audio_manager_module_descriptor for the specified ID.
+ *
+ * Returns zero on success, or a negative value on error.
+ */
+int gb_audio_manager_remove(int id);
+
+/*
+ * Removes all connected gb_audio_modules
+ *
+ * Returns zero on success, or a negative value on error.
+ */
+void gb_audio_manager_remove_all(void);
+
+/*
+ * Retrieves a gb_audio_manager_module_descriptor for the specified id.
+ * Returns the gb_audio_manager_module_descriptor structure,
+ * or NULL if there is no module with the specified ID.
+ */
+struct gb_audio_manager_module *gb_audio_manager_get_module(int id);
+
+/*
+ * Decreases the refcount of the module, obtained by the get function.
+ * Modules are removed via gb_audio_manager_remove
+ */
+void gb_audio_manager_put_module(struct gb_audio_manager_module *module);
+
+/*
+ * Dumps the module for the specified id
+ * Return 0 on success
+ */
+int gb_audio_manager_dump_module(int id);
+
+/*
+ * Dumps all connected modules
+ */
+void gb_audio_manager_dump_all(void);
+
+#endif /* _GB_AUDIO_MANAGER_H_ */
