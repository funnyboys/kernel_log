commit ec0ad868173da8a75121f9dc116a5d5478ff614d
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Sun Aug 25 07:54:27 2019 +0200

    staging: greybus: move core include files to include/linux/greybus/
    
    With the goal of moving the core of the greybus code out of staging, the
    include files need to be moved to include/linux/greybus.h and
    include/linux/greybus/
    
    Cc: Vaibhav Hiremath <hvaibhav.linux@gmail.com>
    Cc: Johan Hovold <johan@kernel.org>
    Cc: Vaibhav Agarwal <vaibhav.sr@gmail.com>
    Cc: Rui Miguel Silva <rmfrfs@gmail.com>
    Cc: David Lin <dtwlin@gmail.com>
    Cc: "Bryan O'Donoghue" <pure.logic@nexus-software.ie>
    Cc: greybus-dev@lists.linaro.org
    Cc: devel@driverdev.osuosl.org
    Acked-by: Mark Greer <mgreer@animalcreek.com>
    Acked-by: Viresh Kumar <viresh.kumar@linaro.org>
    Acked-by: Alex Elder <elder@kernel.org>
    Link: https://lore.kernel.org/r/20190825055429.18547-8-gregkh@linuxfoundation.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/greybus/firmware.h b/drivers/staging/greybus/firmware.h
index 72dfabfa4704..5d2564462ffc 100644
--- a/drivers/staging/greybus/firmware.h
+++ b/drivers/staging/greybus/firmware.h
@@ -9,7 +9,7 @@
 #ifndef __FIRMWARE_H
 #define __FIRMWARE_H
 
-#include "greybus.h"
+#include <linux/greybus.h>
 
 #define FW_NAME_PREFIX	"gmp_"
 

commit baeeb02ccd704e3a6cdff95a78a41916e6a85b21
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Sun Aug 25 07:54:21 2019 +0200

    staging: greybus: fix up SPDX comment in .h files
    
    When these files originally got an SPDX tag, I used // instead of /* */
    for the .h files.  Fix this up to use // properly.
    
    Cc: Johan Hovold <johan@kernel.org>
    Cc: greybus-dev@lists.linaro.org
    Cc: devel@driverdev.osuosl.org
    Acked-by: Viresh Kumar <viresh.kumar@linaro.org>
    Acked-by: Alex Elder <elder@kernel.org>
    Link: https://lore.kernel.org/r/20190825055429.18547-2-gregkh@linuxfoundation.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/greybus/firmware.h b/drivers/staging/greybus/firmware.h
index 946221307ef6..72dfabfa4704 100644
--- a/drivers/staging/greybus/firmware.h
+++ b/drivers/staging/greybus/firmware.h
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+/* SPDX-License-Identifier: GPL-2.0 */
 /*
  * Greybus Firmware Management Header
  *

commit 863dbc52e7f0e5acd7b4883f3933543a81c474c7
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Tue Nov 7 14:58:42 2017 +0100

    staging: greybus: Remove redundant license text
    
    Now that the SPDX tag is in all greybus files, that identifies the
    license in a specific and legally-defined manner.  So the extra GPL text
    wording can be removed as it is no longer needed at all.
    
    This is done on a quest to remove the 700+ different ways that files in
    the kernel describe the GPL license text.  And there's unneeded stuff
    like the address (sometimes incorrect) for the FSF which is never
    needed.
    
    No copyright headers or other non-license-description text was removed.
    
    Cc: Vaibhav Hiremath <hvaibhav.linux@gmail.com>
    Reviewed-by: Alex Elder <elder@linaro.org>
    Acked-by: Vaibhav Agarwal <vaibhav.sr@gmail.com>
    Acked-by: David Lin <dtwlin@gmail.com>
    Acked-by: Johan Hovold <johan@kernel.org>
    Acked-by: Viresh Kumar <viresh.kumar@linaro.org>
    Acked-by: Mark Greer <mgreer@animalcreek.com>
    Acked-by: Rui Miguel Silva <rmfrfs@gmail.com>
    Acked-by: "Bryan O'Donoghue" <pure.logic@nexus-software.ie>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/greybus/firmware.h b/drivers/staging/greybus/firmware.h
index b59f7885402a..946221307ef6 100644
--- a/drivers/staging/greybus/firmware.h
+++ b/drivers/staging/greybus/firmware.h
@@ -4,8 +4,6 @@
  *
  * Copyright 2016 Google Inc.
  * Copyright 2016 Linaro Ltd.
- *
- * Released under the GPLv2 only.
  */
 
 #ifndef __FIRMWARE_H

commit eb50fd3a22c770f36be275295b782f3ea52e3215
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Tue Nov 7 14:58:41 2017 +0100

    staging: greybus: add SPDX identifiers to all greybus driver files
    
    It's good to have SPDX identifiers in all files to make it easier to
    audit the kernel tree for correct licenses.
    
    Update the drivers/staging/greybus files files with the correct SPDX
    license identifier based on the license text in the file itself.  The
    SPDX identifier is a legally binding shorthand, which can be used
    instead of the full boiler plate text.
    
    This work is based on a script and data from Thomas Gleixner, Philippe
    Ombredanne, and Kate Stewart.
    
    Cc: Vaibhav Hiremath <hvaibhav.linux@gmail.com>
    Cc: "Bryan O'Donoghue" <pure.logic@nexus-software.ie>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Cc: Kate Stewart <kstewart@linuxfoundation.org>
    Cc: Philippe Ombredanne <pombredanne@nexb.com>
    Acked-by: Vaibhav Agarwal <vaibhav.sr@gmail.com>
    Acked-by: David Lin <dtwlin@gmail.com>
    Reviewed-by: Alex Elder <elder@linaro.org>
    Acked-by: Johan Hovold <johan@kernel.org>
    Acked-by: Viresh Kumar <viresh.kumar@linaro.org>
    Acked-by: Mark Greer <mgreer@animalcreek.com>
    Acked-by: Rui Miguel Silva <rmfrfs@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/greybus/firmware.h b/drivers/staging/greybus/firmware.h
index f4f0db1cefe8..b59f7885402a 100644
--- a/drivers/staging/greybus/firmware.h
+++ b/drivers/staging/greybus/firmware.h
@@ -1,3 +1,4 @@
+// SPDX-License-Identifier: GPL-2.0
 /*
  * Greybus Firmware Management Header
  *

commit ac96a609dca8b1909f93d13277dd5368e2de5a2a
Author: Viresh Kumar <viresh.kumar@linaro.org>
Date:   Thu Aug 11 13:27:25 2016 -0700

    greybus: firmware: add comment to show size calculations
    
    The firmware file name's maximum length is set to 56 right now, but it
    isn't very much readable how we got to that value (unless someone reads
    that line).
    
    Update the comment to show calculations.
    
    Reported-by: Alex Elder <alex.elder@linaro.org>
    Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@google.com>

diff --git a/drivers/staging/greybus/firmware.h b/drivers/staging/greybus/firmware.h
index ec6bfb7f95c0..f4f0db1cefe8 100644
--- a/drivers/staging/greybus/firmware.h
+++ b/drivers/staging/greybus/firmware.h
@@ -14,7 +14,10 @@
 
 #define FW_NAME_PREFIX	"gmp_"
 
-/* Length of the string in format: "FW_NAME_PREFIX""%08x_%08x_%08x_%08x_%s.tftf" */
+/*
+ * Length of the string in format: "FW_NAME_PREFIX""%08x_%08x_%08x_%08x_%s.tftf"
+ *                                  (3 + 1 + 4 * (8 + 1) + 10 + 1 + 4 + 1)
+ */
 #define FW_NAME_SIZE		56
 
 /* Firmware Management Protocol specific functions */

commit b2abeaa10d5711e7730bb07120dd60ae27d7b930
Author: Viresh Kumar <viresh.kumar@linaro.org>
Date:   Thu Aug 11 13:27:23 2016 -0700

    greybus: firmware: s/_LEN/_SIZE
    
    Alex Elder pointed out that the macros also count the trailing NULL
    ('\0') character and so it should be using SIZE instead of LEN.
    
    This patch makes that change.
    
    Reported-by: Alex Elder <alex.elder@linaro.org>
    Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@google.com>

diff --git a/drivers/staging/greybus/firmware.h b/drivers/staging/greybus/firmware.h
index 841a0d532288..ec6bfb7f95c0 100644
--- a/drivers/staging/greybus/firmware.h
+++ b/drivers/staging/greybus/firmware.h
@@ -15,7 +15,7 @@
 #define FW_NAME_PREFIX	"gmp_"
 
 /* Length of the string in format: "FW_NAME_PREFIX""%08x_%08x_%08x_%08x_%s.tftf" */
-#define FW_NAME_LEN		56
+#define FW_NAME_SIZE		56
 
 /* Firmware Management Protocol specific functions */
 int fw_mgmt_init(void);

commit 350e3ac2ceb696435efbbe688e6e912801a4b8c4
Author: Joel Porquet <porquet_joel@projectara.com>
Date:   Thu Jul 21 15:57:38 2016 -0700

    greybus: firmware.h: rename TFTF firmware filenames
    
    Replace prefix "ara_" with prefix "gmp_" for TFTF firmware filenames.
    
    Testing Done: compiled and flashed EVT2 (bootimage) and tested that
                  "gmp_" prefixed tftf files are expected. Pushed one from
                  FDK and checked that it's properly loaded.
    
    Signed-off-by: Joel Porquet <porquet_joel@projectara.com>
    Acked-by: Viresh Kumar <viresh.kumar@linaro.org>
    Acked-by: Sandeep Patil <sspatil@google.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@google.com>

diff --git a/drivers/staging/greybus/firmware.h b/drivers/staging/greybus/firmware.h
index 2fbb263895d2..841a0d532288 100644
--- a/drivers/staging/greybus/firmware.h
+++ b/drivers/staging/greybus/firmware.h
@@ -12,7 +12,7 @@
 
 #include "greybus.h"
 
-#define FW_NAME_PREFIX	"ara_"
+#define FW_NAME_PREFIX	"gmp_"
 
 /* Length of the string in format: "FW_NAME_PREFIX""%08x_%08x_%08x_%08x_%s.tftf" */
 #define FW_NAME_LEN		56

commit 8a704565ebda9603c294aacebb34e47cd9d9a3a0
Author: Greg Kroah-Hartman <gregkh@google.com>
Date:   Wed Jul 20 10:11:37 2016 -0700

    greybus: move all firmware prefix strings to one place
    
    The firmware prefix is hard-coded in a few different places.  Put it all
    in one handy #define, for when/if we ever decide to change it in the
    future...
    
    Testing: 'strings gb-firmware.ko gb-bootrom.ko | grep ara_' produced the
             same output before and after this patch.
    
    Signed-off-by: Greg Kroah-Hartman <gregkh@google.com>
    Reviewed-by: Viresh Kumar <viresh.kumar@linaro.org>
    Acked-by: Sandeep Patil <sspatil@google.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@google.com>

diff --git a/drivers/staging/greybus/firmware.h b/drivers/staging/greybus/firmware.h
index fb955379cfe4..2fbb263895d2 100644
--- a/drivers/staging/greybus/firmware.h
+++ b/drivers/staging/greybus/firmware.h
@@ -12,6 +12,11 @@
 
 #include "greybus.h"
 
+#define FW_NAME_PREFIX	"ara_"
+
+/* Length of the string in format: "FW_NAME_PREFIX""%08x_%08x_%08x_%08x_%s.tftf" */
+#define FW_NAME_LEN		56
+
 /* Firmware Management Protocol specific functions */
 int fw_mgmt_init(void);
 void fw_mgmt_exit(void);

commit e3eda54d0b5fef23957cc4f586f4b44fd223c881
Author: Viresh Kumar <viresh.kumar@linaro.org>
Date:   Thu Jun 30 10:54:00 2016 -0500

    greybus: Add Component Authentication Protocol support
    
    This patch adds Component Authentication Protocol support in greybus.
    The purpose of the CAP protocol is to authenticate the Module hardware,
    and it can only be used when it is present as part of the
    firmware-management bundle, on a separate CPort.
    
    Compile tested only.
    
    Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>
    Reviewed-by: Jun Li <li_jun@projectara.com>
    Tested-by: Jun Li <li_jun@projectara.com>
    Signed-off-by: Alex Elder <elder@linaro.org>

diff --git a/drivers/staging/greybus/firmware.h b/drivers/staging/greybus/firmware.h
index a82d0203971b..fb955379cfe4 100644
--- a/drivers/staging/greybus/firmware.h
+++ b/drivers/staging/greybus/firmware.h
@@ -25,4 +25,10 @@ int gb_fw_download_request_handler(struct gb_operation *op);
 int gb_fw_download_connection_init(struct gb_connection *connection);
 void gb_fw_download_connection_exit(struct gb_connection *connection);
 
+/* CAP Protocol specific functions */
+int cap_init(void);
+void cap_exit(void);
+int gb_cap_connection_init(struct gb_connection *connection);
+void gb_cap_connection_exit(struct gb_connection *connection);
+
 #endif /* __FIRMWARE_H */

commit 013e665372733fafd08599f0fc58ff5f450e4694
Author: Viresh Kumar <viresh.kumar@linaro.org>
Date:   Sat May 14 23:42:21 2016 +0530

    greybus: fw-management: Add firmware-management protocol driver
    
    This patch adds Firmware Management Protocol support to firmware core,
    which allows the AP to manage firmware on an Interface.
    
    Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>
    Reviewed-by: Jun Li <li_jun@projectara.com>
    Tested-by: Karthik Ravi Shankar <karthikrs@google.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@google.com>

diff --git a/drivers/staging/greybus/firmware.h b/drivers/staging/greybus/firmware.h
index c5736d5f96a2..a82d0203971b 100644
--- a/drivers/staging/greybus/firmware.h
+++ b/drivers/staging/greybus/firmware.h
@@ -12,6 +12,14 @@
 
 #include "greybus.h"
 
+/* Firmware Management Protocol specific functions */
+int fw_mgmt_init(void);
+void fw_mgmt_exit(void);
+struct gb_connection *to_fw_mgmt_connection(struct device *dev);
+int gb_fw_mgmt_request_handler(struct gb_operation *op);
+int gb_fw_mgmt_connection_init(struct gb_connection *connection);
+void gb_fw_mgmt_connection_exit(struct gb_connection *connection);
+
 /* Firmware Download Protocol specific functions */
 int gb_fw_download_request_handler(struct gb_operation *op);
 int gb_fw_download_connection_init(struct gb_connection *connection);

commit cca22207673896262443c72f19b049552d65f88e
Author: Viresh Kumar <viresh.kumar@linaro.org>
Date:   Thu Apr 28 10:06:38 2016 +0530

    greybus: firmware: Add firmware-download protocol driver
    
    This patch adds Firmware Download Protocol support to firmware core,
    which allows an Interface to download a firmware package over Unipro.
    
    Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>
    Reviewed-by: Jun Li <li_jun@projectara.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@google.com>

diff --git a/drivers/staging/greybus/firmware.h b/drivers/staging/greybus/firmware.h
new file mode 100644
index 000000000000..c5736d5f96a2
--- /dev/null
+++ b/drivers/staging/greybus/firmware.h
@@ -0,0 +1,20 @@
+/*
+ * Greybus Firmware Management Header
+ *
+ * Copyright 2016 Google Inc.
+ * Copyright 2016 Linaro Ltd.
+ *
+ * Released under the GPLv2 only.
+ */
+
+#ifndef __FIRMWARE_H
+#define __FIRMWARE_H
+
+#include "greybus.h"
+
+/* Firmware Download Protocol specific functions */
+int gb_fw_download_request_handler(struct gb_operation *op);
+int gb_fw_download_connection_init(struct gb_connection *connection);
+void gb_fw_download_connection_exit(struct gb_connection *connection);
+
+#endif /* __FIRMWARE_H */

commit 5a53e02eaf223c42c6ca8d9664c1191ea7c2b106
Author: Viresh Kumar <viresh.kumar@linaro.org>
Date:   Sun Apr 3 12:18:35 2016 +0530

    greybus: firmware: Rename to bootrom protocol
    
    Align with Greybus specifications and rename Firmware Protocol driver as
    Bootrom Protocol driver.
    
    Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@google.com>

diff --git a/drivers/staging/greybus/firmware.h b/drivers/staging/greybus/firmware.h
deleted file mode 100644
index f25744c1648e..000000000000
--- a/drivers/staging/greybus/firmware.h
+++ /dev/null
@@ -1,16 +0,0 @@
-/*
- * Greybus firmware code
- *
- * Copyright 2015 Google Inc.
- * Copyright 2015 Linaro Ltd.
- *
- * Released under the GPLv2 only.
- */
-
-#ifndef __FIRMWARE_H
-#define __FIRMWARE_H
-
-int gb_firmware_init(void);
-void gb_firmware_exit(void);
-
-#endif /* __FIRMWARE_H */

commit 8ec589b9796eebfa266d2b047ee2318541814e28
Author: Johan Hovold <johan@hovoldconsulting.com>
Date:   Fri Jan 29 15:42:31 2016 +0100

    greybus: firmware: convert to bundle driver
    
    Convert the legacy firmware protocol driver to a bundle driver.
    
    This also fixes a potential crash should a (malicious) module have sent
    an early request before the private data had been initialised.
    
    Note that the firmware protocol needs to support the version request
    indefinitely since it has been burnt into ROM.
    
    In order to avoid having to update current module-loading scripts, keep
    this driver internal to greybus core at least until modalias support is
    added.
    
    Note that there is no MODULE_DEVICE_TABLE defined for firmware as we
    cannot have two greybus tables in one module on ancient 3.10 kernels and
    that the legacy driver is currently also internal to core. This needs be
    added once the driver can be built as a module.
    
    Testing Done: Tested on DB3.
    
    Reviewed-by: Viresh Kumar <viresh.kumar@linaro.org>
    Signed-off-by: Johan Hovold <johan@hovoldconsulting.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@google.com>

diff --git a/drivers/staging/greybus/firmware.h b/drivers/staging/greybus/firmware.h
index 548d297eec63..f25744c1648e 100644
--- a/drivers/staging/greybus/firmware.h
+++ b/drivers/staging/greybus/firmware.h
@@ -10,7 +10,7 @@
 #ifndef __FIRMWARE_H
 #define __FIRMWARE_H
 
-int gb_firmware_protocol_init(void);
-void gb_firmware_protocol_exit(void);
+int gb_firmware_init(void);
+void gb_firmware_exit(void);
 
 #endif /* __FIRMWARE_H */

commit 90f1b617d88f145506e9061436069583cb82d101
Author: Viresh Kumar <viresh.kumar@linaro.org>
Date:   Wed Aug 12 09:19:33 2015 +0530

    greybus: Add firmware protocol driver
    
    This adds firmware protocol driver based on the latest specs available
    on mailing lists. This uses the firmware framework present in kernel.
    
    Refer Documentation/firmware_class/README on how it works.
    
    Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@google.com>

diff --git a/drivers/staging/greybus/firmware.h b/drivers/staging/greybus/firmware.h
new file mode 100644
index 000000000000..548d297eec63
--- /dev/null
+++ b/drivers/staging/greybus/firmware.h
@@ -0,0 +1,16 @@
+/*
+ * Greybus firmware code
+ *
+ * Copyright 2015 Google Inc.
+ * Copyright 2015 Linaro Ltd.
+ *
+ * Released under the GPLv2 only.
+ */
+
+#ifndef __FIRMWARE_H
+#define __FIRMWARE_H
+
+int gb_firmware_protocol_init(void);
+void gb_firmware_protocol_exit(void);
+
+#endif /* __FIRMWARE_H */
